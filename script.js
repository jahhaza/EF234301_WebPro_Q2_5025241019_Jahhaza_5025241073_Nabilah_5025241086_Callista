const productsData = {
            categories: [
                {
                    id: 'rice',
                    name: 'Rice',
                    products: [
                        {
                            id: 1,
                            name: 'Setra Ramos — 5 kg',
                            description: 'Setra Ramos is a popular medium-texture white rice variety widely eaten in Indonesian households. It is known for a soft, slightly sticky texture when cooked, making it suitable for daily meals and for pairing with a variety of local dishes. The grains are relatively short-to-medium in size and tend to cook into a pleasantly fluffy plate of rice.Sourcing for Setra Ramos is usually regional (Java / West Java production areas), and many packaged products carry brand or “cap” names that indicate milling and packaging origin. For shoppers who want dependable everyday rice with consistent cooking results, Setra Ramos is often recommended for both family use and small food businesses. Storage is straightforward — keep in a cool, dry place in its sealed bag to preserve aroma and avoid pests; once opened, transfer to a sealed container if you plan to keep it for months. For best results, rinse before cooking and adjust water ratio slightly by rice type.',
                            price: 'Rp 85.000',
                            wholesale: 'Wholesale (≥11 units): Rp 76.500',
                            image: 'SetraRamos.jpg',
                            category: 'rice'
                        },
                        {
                            id: 2,
                            name: 'Beras IR64 — 5 kg',
                            description: 'IR64 is a long-established rice variety (commonly traded as “IR64” or marketed within the Setra Ramos family) valued for its affordability and balanced texture — neither overly sticky nor too dry. It’s a practical choice for households and small eateries that need reliable yield and good palatability across many Indonesian recipes. Many packaged IR64 products advertise consistent milling quality and standardized grain length, and they are positioned at the affordable-to-mid price tier. It’s suitable for everyday consumption and pairs well with soups, stir-fries, and sambal-based dishes. When cooking IR64, standard rice-to-water ratios apply, but slight adjustments (plus rinsing) will provide a cleaner, fluffier result. Keep sealed and away from humidity to preserve quality.',
                            price: 'Rp 92.500',
                            wholesale: 'Wholesale (≥11 units): Rp 83.250',
                            image: 'BerasIR64.jpg',
                            category: 'rice'
                        },
                        {
                            id: 3,
                            name: 'Pandan Wangi — 5 kg',
                            description: 'Pandan Wangi (jasmine-scented rice) is prized for its fragrant aroma and soft, tender texture after cooking. This variety is commonly chosen for family meals, festive occasions, and whenever a slightly floral fragrance is preferred — it enhances flavor when served with lighter, aromatic dishes. Packaged Pandan Wangi products often emphasize aroma and “pulen” (soft/pulpy) texture; brands position them as premium everyday rice for consumers who appreciate scent and mouthfeel. Because aroma is a chief selling point, proper storage (airtight containers) helps retain the fragrance. Cooking tips: rinse until water runs clearer to remove surface dust, then cook with slightly less water than usual for a firmer yet fragrant finish. Serve warm and enjoy its subtle jasmine notes.',
                            price: 'Rp 103.900',
                            wholesale: 'Wholesale (≥11 units): Rp 93.510',
                            image: 'PandanWangi.jpg',
                            category: 'rice'
                        },
                        {
                            id: 4,
                            name: 'Rojolele Pandan Wangi — 5 kg',
                            description: 'Rojolele is a rice variety appreciated for its roundish, plump grains and naturally soft texture on cooking — many consumers call it “pulen” for its pleasant tenderness. When sold in the pandan-wangi (fragrant) variant, Rojolele offers both soft mouthfeel and gentle aroma, making it popular for daily meals and small family gatherings. As a retail product, Rojolele is often marketed to shoppers who want a balance between texture and aroma without paying the highest premium prices. Packaging typically lists cooking suggestions and origin information to help buyers decide. For best results, rinse and soak briefly if you prefer extra-soft rice; store in a cool, dry place to maintain grain integrity and prevent oxidation.',
                            price: 'Rp 90.000',
                            wholesale: 'Wholesale (≥11 units): Rp 81.000',
                            image: 'Rojolele.jpg',
                            category: 'rice'
                        }
                    ]
                },
                {
                    id: 'cooking-oil',
                    name: 'Cooking Oil',
                    products: [
                        {
                            id: 5,
                            name: 'Bimoli — Cooking Oil (Pouch) 2 L',
                            description: 'Bimoli is one of Indonesia’s most recognized cooking-oil brands, widely used in both households and small food businesses. The product is positioned as a general-purpose palm-based cooking oil that fries crisply, resists burning at normal home frying temperatures, and maintains a neutral taste that lets local spices and sauces shine. Bimoli’s pouch packaging (2 L) is convenient for refilling smaller bottles at home or for use in kitchens that prefer economical pouch packaging. On the label you’ll typically find storage and handling guidance, plus information about filtration and oil clarity. Many shoppers choose Bimoli for everyday frying, stir-frying, and as an all-round oil for Indonesian home cooking — a reliable everyday SKU that balances quality and price. Because it’s a mass-market staple, the product is widely available and easy to reorder; it’s commonly sold in multipacks to support bulk pricing. For FreshAndFix, Bimoli 2 L is ideal as a core SKU: display the retail price prominently and show the wholesale tier (e.g., savings for multiple pouches). Store instructions recommend keeping the pouch sealed and away from direct sunlight; for opened pouches, transfer to a clean, dry container.',
                            price: 'Rp 40.000',
                            wholesale: 'Wholesale (≥11 units): Rp 36.000',
                            image: 'Bimoli.jpg',
                            category: 'cooking-oil'
                        },
                        {
                            id: 6,
                            name: 'Filma — Cooking Oil (Pouch) 2 L',
                            description: 'Filma cooking oil is another widely distributed Indonesian brand, often chosen for its competitive price and predictable frying performance. Filma’s 2 L pouch packaging is common for both family kitchens and small food vendors who need convenient refills. The oil is refined for clarity and shelf stability, and the brand often emphasizes hygienic packaging and broad retail availability. Filma’s positioning tends to target value-conscious consumers who still want a reliable oil for everyday use: frying, deep-frying, and sautéing. Many retail listings present Filma as an economical choice, often promoted in multipacks or bundled deals that appeal to shoppers looking to save per unit. The product information typically includes usage recommendations and recycling/disposal guidance for the pouch. For an e-commerce catalog, Filma 2 L works well in the “staples” row and should show both retail and wholesale tiers. Keep stock and carton-pack offers visible to encourage bulk purchases.',
                            price: 'Rp 39.000',
                            wholesale: 'Wholesale (≥11 units): Rp 35.100',
                            image: 'Filma.jpg',
                            category: 'cooking-oil'
                        },
                        {
                            id: 7,
                            name: 'Tropical — Cooking Oil (Bottle) 2 L',
                            description: 'Tropical is a commonly found brand and is known for clear, neutral-flavored cooking oil suitable for all-purpose home cooking. The brand’s 2 L bottles and pouches are marketed for families and small vendors; Tropical emphasizes clarity and a neutral taste profile so it does not mask the flavour of cooked food. Its packaging options (bottle vs pouch) allow some shoppers to prefer the sturdiness of a bottle while others choose the pouch for economical storage. Tropical often appears in promotional deals and supermarket flyers; it’s positioned in the mainstream segment where consumers expect consistent frying behavior and easy availability across retail channels. As with other palm-based mass-market oils, Tropical’s product pages typically highlight the product’s intended uses and storage tips. On FreshAndFix, Tropical 2 L can serve as an attractive mid-tier SKU — include bundle pricing and show wholesale savings for larger buyers.',
                            price: 'Rp 39.500',
                            wholesale: 'Wholesale (≥11 units): Rp 35.550',
                            image: 'Tropical.jpg',
                            category: 'cooking-oil'
                        },
                        {
                            id: 8,
                            name: 'Sunco — Cooking Oil (Pouch) 2 L',
                            description: 'Sunco is produced by a major edible-oil company and is marketed for households who want a clear, light-textured frying oil. Sunco’s formula aims to be light (not greasy) after frying, making it a common choice for daily cooking routines that include deep frying or stir-frying. The brand is widely available in supermarkets and online marketplaces. Sunco’s packaging includes both bottles and economical pouches; price promotions and multi-pack cartons are commonly found in e-commerce listings. Sunco often appears in curated “best-of” lists for household cooking oils due to a balance of performance and price stability. For shoppers who prioritize consistent texture and neutral taste, Sunco is a dependable option. For FreshAndFix, list Sunco 2 L with clear product imagery and include the tiered-pricing table (retail vs wholesale) so small businesses can quickly spot per-unit savings.',
                            price: 'Rp 39.500',
                            wholesale: 'Wholesale (≥11 units): Rp 35.550',
                            image: 'Sunco.jpg',
                            category: 'cooking-oil'
                        }
                    ]
                },
                {
                    id: 'sugar',
                    name: 'Sugar & Sweeteners',
                    products: [
                        {
                            id: 9,
                            name: 'Gulaku — Cane Sugar (Granulated) 1 kg',
                            description: 'IGulaku is Indonesia’s leading packaged cane sugar brand and a staple in many households. The product offers a clean, sweet profile suitable for beverages, baking, and everyday cooking. Packaging typically highlights that it is refined from cane for consistent crystal size and predictable sweetness. As a retail SKU, Gulaku 1 kg is popular because of its brand recognition and reliable taste: cafes, home cooks, and small eateries often rely on Gulaku for consistent results when brewing coffee, making desserts, or cooking. Nutritional and handling instructions are clearly printed on the bag to reassure shoppers. For storage, keep Gulaku in a cool, dry place and seal after opening to prevent clumping. For FreshAndFix, show both the retail price and a wholesale tier for customers who want to stock up or resell.',
                            price: 'Rp 23.000',
                            wholesale: 'Wholesale (≥11 units): Rp 20.700',
                            image: 'Gulaku.jpg',
                            category: 'sugar'
                        },
                        {
                            id: 10,
                            name: 'Rose Brand — White Crystal Sugar 1 kg',
                            description: 'Rose Brand crystal sugar is a commonly sold white sugar variant that appeals to home bakers and professional kitchens. Its fine-to-medium crystals dissolve easily, making it suitable for syrups, beverages, and desserts. Branding emphasizes purity and consistent grain size. Retail listings typically present Rose Brand as an alternate premium-to-mainstream choice, often appearing alongside other national brands in supermarkets and e-commerce stores. Packaging usually includes cooking suggestions and batch/packaging dates. Rose Brand is a practical SKU for shoppers wanting predictable sweetness and smooth texture in recipes. For FreshAndFix, display per-unit and wholesale prices and show savings clearly.',
                            price: 'Rp 26.000',
                            wholesale: 'Wholesale (≥11 units): Rp 23.400',
                            image: 'RoseBrand.jpg',
                            category: 'sugar'
                        },
                        {
                            id: 11,
                            name: 'KTM / GMP — White Crystal Sugar 1 kg',
                            description: 'KTM / GMP (local crystal sugar listings) represent many white sugar SKUs sold under trade-pack labels; they are frequent choices for value-conscious shoppers and smaller cafes. These products are typically offered as standard granulated sugar with clear labeling about weight and origin. Because KTM/GMP products are often competitively priced, they are used in promotions and carton deals for resale or bulk home stocking. They dissolve readily and are suitable for everyday kitchen uses including beverages and baking. On an e-commerce catalog, KTM/GMP-style sugar is a useful “value” option to pair with premium brands. Display exact milling/packaging dates where available to build buyer trust.',
                            price: 'Rp 22.000',
                            wholesale: 'Wholesale (≥11 units): Rp 19.800',
                            image: 'KTMSugar.jpg',
                            category: 'sugar'
                        },
                        {
                            id: 12,
                            name: 'Cap Onta — Rock / Crystal Sugar 1 kg',
                            description: 'Cap Onta rock sugar (cut crystal sugar) is typically sold in chunks rather than fine granules and is a traditional ingredient in some Indonesian drinks, sweets, and certain regional recipes. Rock sugar melts slowly and is often preferred for syrups or recipes requiring gentle caramelization. Retail listings commonly show Cap Onta and similar rock-sugar brands as specialty items alongside standard granulated sugar. Rock sugar also appeals to shoppers preparing herbal drinks, certain traditional desserts, or commercial syrup-making. For FreshAndFix, label rock sugar clearly (type: rock/crystal) and include usage notes. Consider promoting it in bundles or as an add-on for beverage-focused customers.',
                            price: 'Rp 22.000',
                            wholesale: 'Wholesale (≥11 units): Rp 19.800',
                            image: 'CapOnta.jpg',
                            category: 'sugar'
                        }
                    ]
                },
                {
                    id: 'eggs-protein',
                    name: 'Eggs & Protein Essentials',
                    products: [
                        {
                            id: 13,
                            name: 'So Good — Fresh Eggs (10 pcs carton)',
                            description: 'So Good Fresh Eggs are packaged for everyday household use and marketed for consistent freshness and handling quality. The carton of 10 is convenient for small families and provides reliable sizing and clean packaging that is easy to store in a refrigerator or cool pantry. The brand often highlights feed and freshness standards to reassure shoppers about quality and taste consistency. These eggs are versatile in home cooking — from simple boiled eggs to baked goods and daily omelettes. Many consumers choose branded, packaged eggs like So Good for predictability in baking recipes, where consistent egg size and freshness matter. The product page usually explains storage tips and best-before guidance to help customers get the best results. As a catalog SKU on FreshAndFix, So Good 10-pack works as a core household item with option for bulk purchase by cafes or small eateries. For bulk buyers we display the wholesale tier so restaurants can plan cost-per-dish calculations.',
                            price: 'Rp 35.000',
                            wholesale: 'Wholesale (≥11 units): Rp 31.500',
                            image: 'SoGoodEggs.jpg',
                            category: 'eggs-protein'
                        },
                        {
                            id: 14,
                            name: 'Omega — Chicken Eggs (10 pcs)',
                            description: 'Omega (and similar local packaged egg brands) supply standard 10-egg cartons frequently sold across supermarkets and online marketplaces. These eggs are positioned for daily consumption and often marketed with simple freshness guarantees and clear packaging dates for buyer confidence. They are a pragmatic choice for households and small food businesses. Cooking with these eggs is straightforward: they work well for frying, boiling, and baking. Sellers often emphasize traceability and handling instructions, and many listings include customer reviews about consistency and freshness. For small eateries or kiosks, the 10-pack is convenient to rotate frequently to keep stock fresh. On FreshAndFix, list Omega or equivalent local-branded 10-packs as a value SKU with easy reorder options and visible bulk discounts for resellers or cafés.',
                            price: 'Rp 24.000',
                            wholesale: 'Wholesale (≥11 units): Rp 21.600',
                            image: 'OmegaEggs.jpg',
                            category: 'eggs-protein'
                        },
                        {
                            id: 15,
                            name: 'Village / Free-Range Eggs (10 pcs)',
                            description: 'Telur Ayam Kampung (village/free-range chicken eggs) are favored by shoppers who want a richer yolk color, slightly different flavor, and perceived higher naturalness compared to standard industrial eggs. Packaged in 10-egg trays for retail, kampung eggs are often sold locally and online as a specialty or premium everyday product. Taste and texture differences make kampung eggs popular for traditional recipes and consumers who value “farm-to-table” sourcing. Because supply is often local and variable, listings may show smaller batch availability and encourage early purchase or subscription for regular customers. Storage and handling guidance is essential to keep kampung eggs fresh. For FreshAndFix, tag these as “free-range / kampung” and display origin information where available to help buyers choose — include wholesale tiers for small restaurants that prefer kampung eggs for signature dishes.',
                            price: 'Rp 72.000',
                            wholesale: 'Wholesale (≥11 units): Rp 64.800',
                            image: 'VillageEggs.jpeg',
                            category: 'eggs-protein'
                        },
                        {
                            id: 16,
                            name: 'Duck Eggs — Telur Bebek (pack 10)',
                            description: 'Duck eggs are a staple in certain regional Indonesian dishes and favored for their richer, creamier yolks and stronger flavor than chicken eggs. Sold in smaller retail packs (for example 4–10 pieces) or larger trays for culinary use, duck eggs are often chosen by bakers and chefs for richness in pastries and special dishes. Because duck eggs are denser and larger on average, they can change texture and taste outcomes in recipes; cooks often adjust liquid ratios when substituting for chicken eggs. Listings for duck eggs typically include handling and storage advice, since they may have slightly different shelf-life characteristics. On FreshAndFix, include duck eggs as a specialty protein SKU — show per-pack price and wholesale tiers so cafes and bakeries can calculate recipe costs accurately.',
                            price: 'Rp 46.000',
                            wholesale: 'Wholesale (≥11 units): Rp 41.400',
                            image: 'DuckEggs.jpg',
                            category: 'eggs-protein'
                        },
                        {
                            id: 17,
                            name: 'Boneless Chicken Breast — Frozen (1 kg pack)',
                            description: 'Boneless chicken breast (fillet) is a lean, high-protein staple for households, cafés, and restaurants. Sold in fresh or frozen 1 kg packs, it is ideal for grilling, stir-frying, or meal-prepping. Market listings show multiple SKUs (fresh/frozen, boneless/thigh vs breast), making fillet a flexible catalog product for varied customer needs. Nutritionally dense and versatile, chicken breast suits customers who prioritize low-fat protein for healthy diets. For small food businesses, consistent supply and predictable per-kilogram pricing are critical; therefore the product is often offered in carton deals or multipacks for wholesale savings. Storage in frozen form prolongs shelf life and simplifies logistics for e-commerce. On FreshAndFix, present boneless chicken breast as a core protein SKU with clear per-kg pricing and a wholesale discount for buyers restocking multiple packs. Use server-side stock verification before confirming orders to avoid overselling.',
                            price: 'Rp 59.000',
                            wholesale: 'Wholesale (≥11 units): Rp 53.100',
                            image: 'DadaBreast.jpg',
                            category: 'eggs-protein'
                        },
                        {
                            id: 18,
                            name: 'Minced Chicken — Ground Chicken 500 g pack',
                            description: 'Minced chicken is a kitchen-ready protein used in many home recipes — from bakso replacements to patties and stir-fries. Available in 500 g packs (fresh or frozen), minced chicken is favored by cooks who want pre-prepared protein that speeds up meal prep without sacrificing versatility. Listings usually indicate fat content and whether the mince is pure chicken or mixed. Small food businesses, kiosks, and households appreciate the ease-of-use and portion sizing of 500 g packs. For retailers, minced chicken often appears in promotional multipacks or frozen cartons that permit safer long-term storage and batch cooking. Product pages commonly list cooking suggestions and safe-handling instructions. FreshAndFix should list minced chicken with clear labeling (fat %, fresh/frozen), and wholesale pricing for buyers who purchase in multiple 500 g packs for daily operations.',
                            price: 'Rp 34.000',
                            wholesale: 'Wholesale (≥11 units): Rp 30.600',
                            image: 'MincedChicken.jpg',
                            category: 'eggs-protein'
                        },
                        {
                            id: 19,
                            name: 'Tofu — Kong Kee (Silken / Firm) 250 g pack',
                            description: 'Packaged tofu (brands like Kong Kee and similar) is a widely used plant-based protein in Indonesian households and small eateries. Available in silken or firm variants, tofu is sold in 200–300 g packs and can be fried, grilled, simmered, or added fresh to soups. Product listings note texture (silken for soups, firm for frying) and often include storage and cooking tips. Tofu is economical, vegetarian-friendly, and popular as a protein alternative — it pairs well with sambals, stir-fried vegetables, and curries. Many online merchants offer multipack deals or fresh delivery options for tofu to ensure food safety and quality. For sellers, labeling about expiry and refrigerated handling is important to maintain buyer trust. On FreshAndFix, categorize tofu under protein essentials with per-pack pricing and wholesale bundles for warungs and small restaurants that frequently use tofu in menus.',
                            price: 'Rp 10.000',
                            wholesale: 'Wholesale (≥11 units): Rp 9.000',
                            image: 'Tofu.jpg',
                            category: 'eggs-protein'
                        },
                        {
                            id: 20,
                            name: 'Tempe — Fresh Tempe (per papan / pack)',
                            description: 'Tempe (fermented soybean cake) is a traditional Indonesian protein staple sold per papan (sheet) or in small packs. Fresh tempe is affordable, nutritious, and used across many daily dishes — fried tempe, tempe bacem, or added to stir-fries. Listings typically show single-sheet prices or small multi-sheet packs for household convenience. Because tempe is perishable, many merchants sell it as a fresh product with quick delivery options. Restaurants and street food vendors buy tempe in larger quantities regularly, making wholesale bundles a logical offering for cost efficiency. Nutritional highlights and cooking tips (how to fry or marinate) help buyers make the most of this protein. FreshAndFix should include tempe with clear refrigeration instructions and wholesale pricing for bulk buyers. Consider subscription or repeat-order options for regular tempe supply.',
                            price: 'Rp 10.800',
                            wholesale: 'Wholesale (≥11 units): Rp 9.720',
                            image: 'Tempe.jpg',
                            category: 'eggs-protein'
                        },
                        {
                            id: 21,
                            name: 'Canned Sardines — 425 g (in tomato sauce)',
                            description: 'Canned sardines are shelf-stable protein essentials for households and small kitchens that need quick, ready-to-eat protein.',
                            price: 'Rp 26.500',
                            wholesale: 'Wholesale (≥11 units): Rp 23.850',
                            image: 'Sardines.png',
                            category: 'eggs-protein'
                        },
                        {
                            id: 22,
                            name: 'Ground Beef / Minced Beef — 500 g pack',
                            description: 'Ground beef is a versatile protein used in patties, meatballs, sauces, and stews.',
                            price: 'Rp 107.000',
                            wholesale: 'Wholesale (≥11 units): Rp 96.300',
                            image: 'GroundBeef.jpg',
                            category: 'eggs-protein'
                        }
                    ]
                },
                {
                    id: 'instant-noodles',
                    name: 'Instant Noodles & Ready-to-eat',
                    products: [
                        {
                            id: 23,
                            name: 'Indomie Mi Goreng — Pack of 5',
                            description: 'Indomie Mi Goreng is an iconic Indonesian instant noodle, famous for its savory seasoning oil, sweet soy sauce, and crispy fried shallot topping.',
                            price: 'Rp 17.850',
                            wholesale: 'Wholesale (≥11 packs): Rp 16.065',
                            image: 'IndomieGoreng.jpg',
                            category: 'instant-noodles'
                        },
                        {
                            id: 24,
                            name: 'Indomie Cup — Mi Instan Cup (single serve)',
                            description: 'Indomie Cup brings the familiar Indomie flavors into a convenient single-serve, microwave/boil cup format.',
                            price: 'Rp 5.000',
                            wholesale: 'Wholesale (≥11 cups): Rp 4.500',
                            image: 'IndomieCup.jpg',
                            category: 'instant-noodles'
                        },
                        {
                            id: 25,
                            name: 'Mie Sedaap — Goreng Pack of 5',
                            description: 'Mie Sedaap Goreng is known for its springy noodle texture and bold seasoning blends.',
                            price: 'Rp 16.700',
                            wholesale: 'Wholesale (≥11 packs): Rp 15.030',
                            image: 'MieSedaap.jpg',
                            category: 'instant-noodles'
                        },
                        {
                            id: 26,
                            name: 'Mie Sedaap Cup — Instant Cup Noodles',
                            description: 'Mie Sedaap Cup delivers the brand\'s popular flavors in a cup format designed for convenience.',
                            price: 'Rp 6.500',
                            wholesale: 'Wholesale (≥11 cups): Rp 5.850',
                            image: 'MieSedaapCup.png',
                            category: 'instant-noodles'
                        },
                        {
                            id: 27,
                            name: 'Supermi — Pack of 5',
                            description: 'Supermi is a popular economy instant noodle brand targeted at budget-conscious households and small food vendors.',
                            price: 'Rp 11.100',
                            wholesale: 'Wholesale (≥11 packs): Rp 9.990',
                            image: 'Supermi.jpg',
                            category: 'instant-noodles'
                        },
                        {
                            id: 28,
                            name: 'Sarimi — Pack of 5',
                            description: 'Sarimi is another instant noodle brand commonly sold in multi-pack formats and known for its affordability and selection of familiar flavors.',
                            price: 'Rp 16.625',
                            wholesale: 'Wholesale (≥11 packs): Rp 14.962',
                            image: 'Sarimi.jpg',
                            category: 'instant-noodles'
                        },
                        {
                            id: 29,
                            name: 'Mamee Express / Cup Noodles — Single Cup',
                            description: 'Mamee Express (cup) is a well-known cup noodle brand offering compact, flavorful single-serve bowls.',
                            price: 'Rp 17.500',
                            wholesale: 'Wholesale (≥11 cups): Rp 15.750',
                            image: 'Mamee.jpg',
                            category: 'instant-noodles'
                        },
                        {
                            id: 30,
                            name: 'Pop Mie — Single Cup',
                            description: 'Pop Mie is a convenient cup-format instant noodle (often with a savory soup base) intended for on-the-go consumption.',
                            price: 'Rp 17.000',
                            wholesale: 'Wholesale (≥11 cups): Rp 15.300',
                            image: 'PopMie.png',
                            category: 'instant-noodles'
                        },
                        {
                            id: 31,
                            name: 'Indomie — Variety / Soup Flavors Pack of 5',
                            description: 'Indomie\'s soup and regional-flavor packs (soto, kari, rendang) expand the brand\'s lineup beyond goreng-style noodles.',
                            price: 'Rp 18.475',
                            wholesale: 'Wholesale (≥11 packs): Rp 16.627',
                            image: 'IndomieSoup.jpg',
                            category: 'instant-noodles'
                        }
                    ]
                },
                {
                    id: 'beverages',
                    name: 'Beverages',
                    products: [
                        {
                            id: 32,
                            name: 'AQUA — Mineral Water 600 ml',
                            description: 'AQUA is Indonesia\'s best-known bottled mineral water brand, sourced from selected mountain springs and processed for consistent taste and purity.',
                            price: 'Rp 3.600',
                            wholesale: 'Wholesale (≥11 units): Rp 3.240',
                            image: 'AquaProduct.jpg',
                            category: 'beverages'
                        },
                        {
                            id: 33,
                            name: 'Teh Botol SOSRO — Jasmine / Original 450 ml',
                            description: 'Teh Botol Sosro is an iconic jasmine-scented ready-to-drink tea beloved across Indonesia for its balanced sweetness and floral aroma.',
                            price: 'Rp 6.750',
                            wholesale: 'Wholesale (≥11 units): Rp 6.075',
                            image: 'TehBotol.jpg',
                            category: 'beverages'
                        },
                        {
                            id: 34,
                            name: 'Teh Pucuk Harum — Jasmine Tea 500 ml',
                            description: 'Teh Pucuk Harum is a popular bottled jasmine tea brand known for its fresh leaf taste and consistent clarity.',
                            price: 'Rp 6.900',
                            wholesale: 'Wholesale (≥11 units): Rp 6.210',
                            image: 'TehPucuk.jpg',
                            category: 'beverages'
                        },
                        {
                            id: 35,
                            name: 'NU GREEN TEA — Green Tea 330 ml',
                            description: 'NU Green Tea is a value-friendly green-tea RTD (ready-to-drink) brand that comes in several formats (330 ml, 450 ml).',
                            price: 'Rp 4.500',
                            wholesale: 'Wholesale (≥11 units): Rp 4.050',
                            image: 'NuGreenTea.jpg',
                            category: 'beverages'
                        },
                        {
                            id: 36,
                            name: 'Pocari Sweat — Ion Water / Isotonic Drink 500 ml',
                            description: 'Pocari Sweat is a widely used isotonic drink tailored to rehydrate quickly after exercise, travel, or hot weather.',
                            price: 'Rp 10.100',
                            wholesale: 'Wholesale (≥11 units): Rp 9.090',
                            image: 'PocariSweat.jpg',
                            category: 'beverages'
                        },
                        {
                            id: 37,
                            name: 'GOOD DAY — Ready-to-Drink Coffee 250 ml',
                            description: 'GOOD DAY RTD coffee (various flavors: Mocca Latte, Caramel, Cappuccino) is a popular bottled/cup coffee aimed at consumers who want a quick caffeine boost.',
                            price: 'Rp 5.750',
                            wholesale: 'Wholesale (≥11 units): Rp 5.175',
                            image: 'GoodDay.jpg',
                            category: 'beverages'
                        },
                        {
                            id: 38,
                            name: 'NESCAFÉ Classic — Instant Coffee Jar 200 g',
                            description: 'NESCAFÉ Classic is a leading instant coffee granule (jar format) used widely for home and small-office brewing.',
                            price: 'Rp 131.000',
                            wholesale: 'Wholesale (≥11 units): Rp 117.900',
                            image: 'Nescafe.jpg',
                            category: 'beverages'
                        },
                        {
                            id: 39,
                            name: 'Indomilk — UHT Milk 1 L (plain)',
                            description: 'Indomilk UHT 1 L is a shelf-stable milk SKU used by households, cafés, and small food businesses.',
                            price: 'Rp 17.600',
                            wholesale: 'Wholesale (≥11 units): Rp 15.840',
                            image: 'IndomilkProduct.jpg',
                            category: 'beverages'
                        },
                        {
                            id: 40,
                            name: 'Ultra Milk — UHT Milk 1 L (Full cream)',
                            description: 'Ultra Milk (Ultra Jaya) offers UHT milk in multiple flavours and sizes; the 1 L carton is a family-sized staple for daily drinking.',
                            price: 'Rp 21.750',
                            wholesale: 'Wholesale (≥11 units): Rp 19.575',
                            image: 'UltraMilk.jpg',
                            category: 'beverages'
                        },
                        {
                            id: 41,
                            name: 'MILO (Nestlé) — Milo Powder 400 g',
                            description: 'MILO is a chocolate malt powder popular for breakfast or as an energy drink when mixed with milk or hot water.',
                            price: 'Rp 48.250',
                            wholesale: 'Wholesale (≥11 units): Rp 43.425',
                            image: 'Milo.jpg',
                            category: 'beverages'
                        },
                        {
                            id: 42,
                            name: 'Buavita — Fruit Juice 1 L (Orange)',
                            description: 'Buavita is a shelf-stable fruit juice brand available in 1 L cartons and recognized for fruit-forward flavors like orange and guava.',
                            price: 'Rp 30.500',
                            wholesale: 'Wholesale (≥11 units): Rp 27.450',
                            image: 'Buavita.jpg',
                            category: 'beverages'
                        },
                        {
                            id: 43,
                            name: 'BEAR BRAND — Sterilized Milk 189 ml',
                            description: 'Bear Brand (Nestlé) sterilized milk is a shelf-stable milk drink sold in small cans (189 ml) for convenient single-serve nutrition.',
                            price: 'Rp 13.500',
                            wholesale: 'Wholesale (≥11 units): Rp 12.150',
                            image: 'BearBrand.jpg',
                            category: 'beverages'
                        },
                        {
                            id: 44,
                            name: 'Teh Kotak (SOSRO) — Jasmine Tea 1 L',
                            description: 'Teh Kotak (Sosro) 1 L is a Tetra Pak tea product for family consumption and pantry use.',
                            price: 'Rp 9.912',
                            wholesale: 'Wholesale (≥11 units): Rp 8.921',
                            image: 'TehKotak.jpg',
                            category: 'beverages'
                        },
                        {
                            id: 45,
                            name: 'MIZONE — Isotonic / Vitamin Water 500 ml',
                            description: 'Mizone is an isotonic vitamin water positioned for active consumers who want hydration with added minerals and vitamins.',
                            price: 'Rp 5.185',
                            wholesale: 'Wholesale (≥11 units): Rp 4.666',
                            image: 'Mizone.jpg',
                            category: 'beverages'
                        },
                        {
                            id: 46,
                            name: 'Kapal Api — RTD Coffee / White Coffee 250 ml',
                            description: 'Kapal Api RTD (ready-to-drink) coffee — including white coffee and cappuccino variants — is a mainstream bottled coffee product for quick consumption.',
                            price: 'Rp 6.175',
                            wholesale: 'Wholesale (≥11 units): Rp 5.557',
                            image: 'KapalApi.jpg',
                            category: 'beverages'
                        }
                    ]
                },
                {
                    id: 'cooking-pantry',
                    name: 'Cooking & Pantry Staples',
                    products: [
                        {
                            id: 47,
                            name: 'Bango — Kecap Manis (Sweet Soy Sauce) 520 ml',
                            description: 'Bango sweet soy sauce is a classic Indonesian seasoning — thick, sweet and savory — that forms the backbone of many home-cooked recipes.',
                            price: 'Rp 25.650',
                            wholesale: 'Wholesale (≥11 units): Rp 23.085',
                            image: 'BangoProduct.jpg',
                            category: 'cooking-pantry'
                        },
                        {
                            id: 48,
                            name: 'ABC — Kecap Manis (Sweet Soy Sauce) 620 ml',
                            description: 'ABC Kecap Manis is another household name in Indonesian kitchens, offering a syrupy, sweet-umami soy sauce used across everyday meals.',
                            price: 'Rp 35.850',
                            wholesale: 'Wholesale (≥11 units): Rp 32.265',
                            image: 'ABCKecap.jpg',
                            category: 'cooking-pantry'
                        },
                        {
                            id: 49,
                            name: 'ABC — Sambal Extra Pedas (Hot Chilli Sauce) 335 ml',
                            description: 'ABC Sambal Extra Pedas is a bottled chili condiment prized for intense heat and bright chili flavor — a go-to table sauce for anyone who likes their food spicy.',
                            price: 'Rp 20.800',
                            wholesale: 'Wholesale (≥11 units): Rp 18.720',
                            image: 'ABCSambal.jpg',
                            category: 'cooking-pantry'
                        },
                        {
                            id: 50,
                            name: 'ABC — Saus Tomat (Tomato Ketchup) 335 g',
                            description: 'ABC tomato sauce (ketchup) is a pantry classic for households and food stalls — sweet, tangy, and smooth, used as a condiment, ingredient for sauces.',
                            price: 'Rp 20.000',
                            wholesale: 'Wholesale (≥11 units): Rp 18.000',
                            image: 'ABCSaus.jpg',
                            category: 'cooking-pantry'
                        },
                        {
                            id: 51,
                            name: 'Royco — Chicken Stock Powder / Seasoning 200 g',
                            description: 'Royco chicken stock powder is a widely used flavor booster for soups, stir-fries, and gravies.',
                            price: 'Rp 11.325',
                            wholesale: 'Wholesale (≥11 units): Rp 10.192',
                            image: 'Royco.jpg',
                            category: 'cooking-pantry'
                        },
                        {
                            id: 52,
                            name: 'Masako — Chicken Seasoning 50 g sachet',
                            description: 'Masako is a compact chicken-flavored seasoning sachet that adds a savory boost to everyday soups, fried rice, and stir-fries.',
                            price: 'Rp 5.000',
                            wholesale: 'Wholesale (≥11 units): Rp 4.500',
                            image: 'Masako.jpg',
                            category: 'cooking-pantry'
                        },
                        {
                            id: 53,
                            name: 'Sajiku — Bumbu Praktis Nasi Goreng 20 g',
                            description: 'Sajiku instant seasoning sachets (nasi goreng, ayam goreng, sayur sop variants) are designed to make cooking traditional Indonesian dishes fast and foolproof.',
                            price: 'Rp 2.750',
                            wholesale: 'Wholesale (≥11 units): Rp 2.475',
                            image: 'Sajiku.jpg',
                            category: 'cooking-pantry'
                        },
                        {
                            id: 54,
                            name: 'Kara — Coconut Milk (Santan) UHT 200 ml',
                            description: 'Kara UHT coconut milk is a reliable, shelf-stable santan option for curries, rendangs, and coconut-based desserts.',
                            price: 'Rp 18.000',
                            wholesale: 'Wholesale (≥11 units): Rp 16.200',
                            image: 'Kara.jpeg',
                            category: 'cooking-pantry'
                        },
                        {
                            id: 55,
                            name: 'Sasa — Santan (Coconut Cream) 65 ml sachet',
                            description: 'Sasa (and Sun Kara) small santan sachets (65 ml) are designed for single-use recipes like rendang or small curry portions.',
                            price: 'Rp 6.000',
                            wholesale: 'Wholesale (≥11 units): Rp 5.400',
                            image: 'SasaProduct.jpg',
                            category: 'cooking-pantry'
                        },
                        {
                            id: 56,
                            name: 'Bamboe — Instant Spice Mixes Rendang 48 g',
                            description: 'Bamboe instant bumbu packs (rendang, gulai, curry, nasi uduk variants) are concentrated seasoning kits designed to replicate traditional Indonesian spice blends quickly.',
                            price: 'Rp 14.500',
                            wholesale: 'Wholesale (≥11 units): Rp 13.050',
                            image: 'Bamboe.jpg',
                            category: 'cooking-pantry'
                        },
                        {
                            id: 57,
                            name: 'Segitiga Biru — All-Purpose Wheat Flour 1 kg',
                            description: 'Segitiga Biru (Bogasari) all-purpose flour is a baking and cooking staple widely used across Indonesia for bread, cakes, batter, and dough.',
                            price: 'Rp 13.650',
                            wholesale: 'Wholesale (≥11 units): Rp 12.285',
                            image: 'SegitigaBiru.jpg',
                            category: 'cooking-pantry'
                        },
                        {
                            id: 58,
                            name: 'Maizena — Corn Starch 250 g',
                            description: 'Corn starch (Maizena / Rose Brand) is a common pantry ingredient used as a thickener for soups, sauces, and desserts.',
                            price: 'Rp 5.450',
                            wholesale: 'Wholesale (≥11 units): Rp 4.905',
                            image: 'Maizena.jpg',
                            category: 'cooking-pantry'
                        }
                    ]
                },
                {
                    id: 'snacks',
                    name: 'Snacks & Confectionery',
                    products: [
                        {
                            id: 59,
                            name: 'Chitato — Classic Potato Chips 68 g',
                            description: 'Chitato is a popular Indonesian potato chip brand known for its thicker, crunchier cuts and rich seasoning.',
                            price: 'Rp 6.500',
                            wholesale: 'Wholesale (≥11 units): Rp 5.850',
                            image: 'Chitato.jpg',
                            category: 'snacks'
                        },
                        {
                            id: 60,
                            name: 'Lay\'s — Potato Chips 68 g',
                            description: 'Lay\'s is an international potato chip brand widely available in Indonesia with consistent thin-crisp texture and a range of classic flavors.',
                            price: 'Rp 8.000',
                            wholesale: 'Wholesale (≥11 units): Rp 7.200',
                            image: 'Lays.jpg',
                            category: 'snacks'
                        },
                        {
                            id: 61,
                            name: 'Pringles — Original 165 g',
                            description: 'Pringles are stackable, uniform-curved potato crisps sold in a tube can; this format keeps chips intact and is convenient for sharing.',
                            price: 'Rp 28.000',
                            wholesale: 'Wholesale (≥11 units): Rp 25.200',
                            image: 'Pringles.jpg',
                            category: 'snacks'
                        },
                        {
                            id: 62,
                            name: 'Cheetos — Cheese Flavored Corn Snacks 68 g',
                            description: 'Cheetos delivers crunchy, cheesy corn snacks with a distinctive orange coating and bold flavor profile that appeals to teens and young adults.',
                            price: 'Rp 7.000',
                            wholesale: 'Wholesale (≥11 units): Rp 6.300',
                            image: 'Cheetos.jpg',
                            category: 'snacks'
                        },
                        {
                            id: 63,
                            name: 'Beng-Beng — Chocolate Wafer Bar 35 g',
                            description: 'Beng-Beng is a locally popular chocolate wafer bar consisting of layers of wafer, caramel, and chocolate coating.',
                            price: 'Rp 3.000',
                            wholesale: 'Wholesale (≥11 units): Rp 2.700',
                            image: 'BengBeng.jpg',
                            category: 'snacks'
                        },
                        {
                            id: 64,
                            name: 'KitKat — Original 4-finger 45 g',
                            description: 'KitKat is a globally recognized chocolate-wafer bar with crisp wafer layers covered in milk chocolate.',
                            price: 'Rp 10.250',
                            wholesale: 'Wholesale (≥11 units): Rp 9.225',
                            image: 'KitKat.jpg',
                            category: 'snacks'
                        },
                        {
                            id: 65,
                            name: 'SilverQueen — Chocolate Bar 65 g',
                            description: 'SilverQueen is a premium Indonesian chocolate brand known for its chunky chocolate slabs studded with peanuts.',
                            price: 'Rp 28.500',
                            wholesale: 'Wholesale (≥11 units): Rp 25.650',
                            image: 'SilverQueen.jpg',
                            category: 'snacks'
                        },
                        {
                            id: 66,
                            name: 'Oreo — Chocolate Sandwich Cookies 137 g',
                            description: 'Oreo is an internationally popular sandwich cookie with chocolate wafers and sweet cream filling.',
                            price: 'Rp 21.500',
                            wholesale: 'Wholesale (≥11 units): Rp 19.350',
                            image: 'Oreo.jpg',
                            category: 'snacks'
                        },
                        {
                            id: 67,
                            name: 'Tango — Wafer Snacks 140 g pack',
                            description: 'Tango offers crispy wafer sticks filled with chocolate or hazelnut cream, packaged for sharing or single-serve indulgence.',
                            price: 'Rp 15.000',
                            wholesale: 'Wholesale (≥11 units): Rp 13.500',
                            image: 'TangoProduct.jpg',
                            category: 'snacks'
                        },
                        {
                            id: 68,
                            name: 'Nabati — Wafer & Cheese Wafer Family Pack',
                            description: 'Nabati produces wafer products (chocolate and cheese variants) that are widely distributed in Indonesia and neighboring markets.',
                            price: 'Rp 18.000',
                            wholesale: 'Wholesale (≥11 units): Rp 16.200',
                            image: 'Nabati.jpg',
                            category: 'snacks'
                        },
                        {
                            id: 69,
                            name: 'Good Time — Chocolate Chip Cookies 165 g',
                            description: 'Good Time cookies are soft-baked chocolate chip cookies packaged either in packs or jars, favored for their homey taste and approachable texture.',
                            price: 'Rp 23.000',
                            wholesale: 'Wholesale (≥11 units): Rp 20.700',
                            image: 'GoodTime.jpg',
                            category: 'snacks'
                        },
                        {
                            id: 70,
                            name: 'Monde — Choco-Pie / Marshmallow Snacks pack',
                            description: 'Monde Choco-Pie is a marshmallow-filled cake coated in chocolate, sold in small individually-wrapped pieces or multi-packs.',
                            price: 'Rp 16.000',
                            wholesale: 'Wholesale (≥11 units): Rp 14.400',
                            image: 'Monde.jpg',
                            category: 'snacks'
                        },
                        {
                            id: 71,
                            name: 'Jack \'n Jill — Roller Coaster Potato Rings 45 g',
                            description: 'Jack \'n Jill Roller Coaster (potato rings) and similar corn/potato snack shapes are playful, crunchy snacks that appeal strongly to children and teens.',
                            price: 'Rp 9.250',
                            wholesale: 'Wholesale (≥11 units): Rp 8.325',
                            image: 'JacknJill.jpg',
                            category: 'snacks'
                        },
                        {
                            id: 72,
                            name: 'Tango — Cheese Rolls / Stick Wafers pack',
                            description: 'Tango Cheese Rolls provide a savory-wafer alternative to chocolate wafers, offering a cheesy filling that pairs well with coffee or as snack-time savory option.',
                            price: 'Rp 13.000',
                            wholesale: 'Wholesale (≥11 units): Rp 11.700',
                            image: 'TangoCheese.jpg',
                            category: 'snacks'
                        },
                        {
                            id: 73,
                            name: 'TimTam — Chocolate Biscuit 200 g',
                            description: 'TimTam is an Australian chocolate biscuit with a crisp biscuit layer, cream filling, and chocolate coating.',
                            price: 'Rp 57.500',
                            wholesale: 'Wholesale (≥11 units): Rp 51.750',
                            image: 'TimTam.jpg',
                            category: 'snacks'
                        },
                        {
                            id: 74,
                            name: 'Toblerone — Chocolate Bar 100 g',
                            description: 'Toblerone is a Swiss triangular chocolate bar known for its honey-almond nougat and distinctive triangular segments ideal for sharing.',
                            price: 'Rp 75.000',
                            wholesale: 'Wholesale (≥11 units): Rp 67.500',
                            image: 'Toblerone.jpg',
                            category: 'snacks'
                        },
                        {
                            id: 75,
                            name: 'Mentos — Chewy Mints / Candy Roll 37 g',
                            description: 'Mentos chewy mints and fruit candies are convenient breath-freshening sweets sold in small tubes or rolls.',
                            price: 'Rp 6.250',
                            wholesale: 'Wholesale (≥11 units): Rp 5.625',
                            image: 'Mentos.jpg',
                            category: 'snacks'
                        },
                        {
                            id: 76,
                            name: 'Haribo — Goldbears Gummi Candy 100 g',
                            description: 'Haribo Goldbears are classic gummi bears from an established international confectioner; they represent an imported gummy candy SKU.',
                            price: 'Rp 45.000',
                            wholesale: 'Wholesale (≥11 units): Rp 40.500',
                            image: 'Haribo.jpg',
                            category: 'snacks'
                        }
                    ]
                }
            ]
        };


        // Voucher data
        const vouchers = [
            {
                code: 'WELCOME10',
                name: 'Welcome Discount 10%',
                discount: 10,
                type: 'percentage',
                minPurchase: 50000,
                description: 'Get 10% off on your first order'
            },
            {
                code: 'FRESH15',
                name: 'Fresh Discount 15%',
                discount: 15,
                type: 'percentage',
                minPurchase: 100000,
                description: 'Get 15% off on orders above Rp 100.000'
            },
            {
                code: 'FIXED20K',
                name: 'Fixed Discount Rp 20.000',
                discount: 20000,
                type: 'fixed',
                minPurchase: 150000,
                description: 'Get Rp 20.000 off on orders above Rp 150.000'
            }
        ];

        // Membership plans
        const membershipPlans = {
            'basic-monthly': {
                name: 'Basic',
                price: 49000,
                period: 'month',
                features: [
                    'Free delivery on orders over Rp 200.000',
                    '5% discount on selected products',
                    'Standard customer support'
                ]
            },
            'premium-monthly': {
                name: 'Premium',
                price: 99000,
                period: 'month',
                features: [
                    'Free delivery on all orders',
                    '10% discount on all products',
                    'Early access to flash sales',
                    'Priority customer support'
                ]
            },
            'business-monthly': {
                name: 'Business',
                price: 199000,
                period: 'month',
                features: [
                    'All Premium features',
                    '15% wholesale discount',
                    'Dedicated account manager',
                    'Bulk order management'
                ]
            }
        };

        // Global variables
        let cart = [];
        let currentUser = null;
        let currentCategory = 'all';
        let checkoutData = {
            address: null,
            outlet: null,
            shipping: null,
            payment: null,
            voucher: null,
            orderTempId: null
        };
        let currentOrder = null;
        let userPoints = 0;
        let appliedVoucher = null;

        // Outlet data
        const outlets = [
            "Jakarta", "Surabaya", "Bandung", "Medan", "Semarang",
            "Makassar", "Palembang", "Tangerang", "Bekasi", "Depok",
            "Yogyakarta", "Denpasar (Bali)", "Malang", "Pontianak", "Batam"
        ];

        // Initialize the website when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Populate flash sale products
            populateFlashSale();
            
            // Populate categories and products
            populateCategories();
            
            // Initialize cart functionality
            initCart();
            
            // Initialize authentication
            initAuth();
            
            // Initialize modals
            initModals();
            
            // Initialize search functionality
            initSearch();
            
            // Initialize flash sale timer
            initFlashSaleTimer();
            
            // Initialize mobile menu
            initMobileMenu();
            
            // Initialize checkout process
            initCheckout();
            
            // Initialize product detail page
            initProductDetailPage();
            
            // Initialize FAQ functionality
            initFAQ();
            
            // Initialize account functionality
            initAccount();
            
            // Initialize membership functionality
            initMembership();
            
            // Initialize voucher functionality
            initVoucher();
        });

        // Initialize FAQ functionality
        function initFAQ() {
            const faqQuestions = document.querySelectorAll('.faq-question');
            
            faqQuestions.forEach(question => {
                question.addEventListener('click', function() {
                    const answer = this.nextElementSibling;
                    const toggle = this.querySelector('.faq-toggle');
                    
                    // Toggle active class
                    answer.classList.toggle('active');
                    toggle.classList.toggle('active');
                });
            });
        }

        // Initialize authentication system
        function initAuth() {
            // Check if user is already logged in
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                updateUserDisplay();
                
                // Load user points
                const savedPoints = localStorage.getItem(`points_${currentUser.id}`);
                if (savedPoints) {
                    userPoints = parseInt(savedPoints);
                }
            }

            // Event listener for user icon
            document.getElementById('user-icon').addEventListener('click', function() {
                if (currentUser) {
                    // Show user dropdown if logged in
                    document.getElementById('user-dropdown').classList.toggle('active');
                    document.getElementById('user-name-display').textContent = currentUser.name;
                } else {
                    // Show login modal if not logged in
                    document.getElementById('login-modal').classList.add('active');
                }
            });

            // Event listener for account button
            document.getElementById('account-btn').addEventListener('click', function() {
                showAccountModal();
                document.getElementById('user-dropdown').classList.remove('active');
            });

            // Event listener for transaction history button
            document.getElementById('transaction-history-btn').addEventListener('click', function() {
                showAccountModal('history');
                document.getElementById('user-dropdown').classList.remove('active');
            });

            // Event listener for logout
            document.getElementById('logout-btn').addEventListener('click', function() {
                logout();
            });

            // Event listener for login form
            document.getElementById('login-form').addEventListener('submit', function(e) {
                e.preventDefault();
                login();
            });

            // Event listener for register form
            document.getElementById('register-form').addEventListener('submit', function(e) {
                e.preventDefault();
                register();
            });

            // Event listener for forgot password form
            document.getElementById('forgot-password-form').addEventListener('submit', function(e) {
                e.preventDefault();
                forgotPassword();
            });

            // Event listener for Google login
            document.getElementById('google-login-btn').addEventListener('click', function() {
                googleLogin();
            });

            // Event listener for Google register
            document.getElementById('google-register-btn').addEventListener('click', function() {
                googleRegister();
            });
        }

        // Initialize account functionality
        function initAccount() {
            // Account tabs
            document.querySelectorAll('.account-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    
                    // Update active tab
                    document.querySelectorAll('.account-tab').forEach(t => {
                        t.classList.remove('active');
                    });
                    this.classList.add('active');
                    
                    // Show corresponding section
                    document.querySelectorAll('.account-section').forEach(section => {
                        section.classList.remove('active');
                    });
                    document.getElementById(`${tabId}-section`).classList.add('active');
                    
                    // Load specific data if needed
                    if (tabId === 'history') {
                        loadTransactionHistory();
                    } else if (tabId === 'points') {
                        loadPointsHistory();
                    } else if (tabId === 'membership') {
                        loadCurrentMembership();
                    }
                });
            });
            
            // Profile form
            document.getElementById('profile-form').addEventListener('submit', function(e) {
                e.preventDefault();
                updateProfile();
            });
            
            // Password form
            document.getElementById('password-form').addEventListener('submit', function(e) {
                e.preventDefault();
                changePassword();
            });
            
            // Close account modal
            document.getElementById('close-account').addEventListener('click', function() {
                document.getElementById('account-modal').classList.remove('active');
            });
        }

        // Initialize membership functionality
        function initMembership() {
            // Event listeners for subscription buttons
            document.querySelectorAll('.subscribe-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const planId = this.getAttribute('data-plan');
                    openSubscriptionModal(planId);
                });
            });
            
            // Event listener for subscription modal close
            document.getElementById('close-subscription').addEventListener('click', function() {
                document.getElementById('subscription-modal').classList.remove('active');
            });
            
            // Event listener for confirm subscription
            document.getElementById('subscription-form').addEventListener('submit', function(e) {
                e.preventDefault();
                confirmSubscription();
            });
            
            // Event listener for manage subscription
            document.getElementById('manage-membership').addEventListener('click', function() {
                openSubscriptionModal('premium-monthly');
            });
            
            // Event listener for cancel membership
            document.getElementById('cancel-membership').addEventListener('click', function() {
                cancelMembership();
            });
        }

        // Initialize voucher functionality
        function initVoucher() {
            // Apply voucher button
            document.getElementById('apply-voucher').addEventListener('click', function() {
                applyVoucher();
            });
            
            // Populate voucher list
            populateVoucherList();
        }

        // Populate voucher list
        function populateVoucherList() {
            const voucherList = document.getElementById('voucher-list');
            voucherList.innerHTML = '';
            
            vouchers.forEach(voucher => {
                const voucherItem = document.createElement('div');
                voucherItem.className = 'voucher-item';
                voucherItem.innerHTML = `
                    <div>
                        <strong>${voucher.name}</strong>
                        <div style="font-size: 12px; color: var(--dark-gray);">${voucher.description}</div>
                        <div style="font-size: 11px; color: var(--dark-green);">Min. purchase: Rp ${voucher.minPurchase.toLocaleString('id-ID')}</div>
                    </div>
                `;
                voucherItem.addEventListener('click', function() {
                    document.querySelectorAll('.voucher-item').forEach(item => {
                        item.classList.remove('selected');
                    });
                    this.classList.add('selected');
                    document.getElementById('voucher-code').value = voucher.code;
                });
                voucherList.appendChild(voucherItem);
            });
        }

        // Apply voucher
        function applyVoucher() {
            const voucherCode = document.getElementById('voucher-code').value;
            const voucher = vouchers.find(v => v.code === voucherCode);
            
            if (!voucher) {
                alert('Kode voucher tidak valid');
                return;
            }
            
            // Calculate subtotal to check minimum purchase
            let subtotal = 0;
            cart.forEach(item => {
                const priceValue = parseInt(item.price.replace(/[^\d]/g, ''));
                subtotal += priceValue * item.quantity;
            });
            
            if (subtotal < voucher.minPurchase) {
                alert(`Minimum pembelian untuk voucher ini adalah Rp ${voucher.minPurchase.toLocaleString('id-ID')}`);
                return;
            }
            
            appliedVoucher = voucher;
            checkoutData.voucher = voucher;
            
            // Update order summary
            populateOrderSummary();
            
            showNotification(`Voucher ${voucher.name} berhasil diterapkan!`);
        }

        // Open subscription modal
        function openSubscriptionModal(planId) {
            const plan = membershipPlans[planId];
            if (!plan) return;
            
            // Update modal title
            document.getElementById('subscription-modal-title').textContent = 
                `Subscribe to ${plan.name} - ${plan.period === 'month' ? 'Monthly' : 'Yearly'}`;
            
            // Update summary
            document.getElementById('summary-plan-name').textContent = 
                `${plan.name} - ${plan.period === 'month' ? 'Monthly' : 'Yearly'}`;
            document.getElementById('summary-plan-price').textContent = 
                `Rp ${plan.price.toLocaleString('id-ID')}`;
            document.getElementById('summary-total-price').textContent = 
                `Rp ${plan.price.toLocaleString('id-ID')}`;
            
            // Store current plan in modal
            document.getElementById('subscription-modal').setAttribute('data-current-plan', planId);
            
            // Show modal
            document.getElementById('subscription-modal').classList.add('active');
        }

        // Confirm subscription
        function confirmSubscription() {
            const planId = document.getElementById('subscription-modal').getAttribute('data-current-plan');
            const plan = membershipPlans[planId];
            
            // Validate form
            const cardNumber = document.getElementById('card-number').value;
            const expiryDate = document.getElementById('expiry-date').value;
            const cvv = document.getElementById('cvv').value;
            const cardName = document.getElementById('card-name').value;
            const autoRenew = document.getElementById('auto-renew').checked;
            
            if (!cardNumber || !expiryDate || !cvv || !cardName) {
                alert('Please fill in all payment details');
                return;
            }
            
            // Calculate next billing date
            const nextBillingDate = new Date();
            if (plan.period === 'month') {
                nextBillingDate.setMonth(nextBillingDate.getMonth() + 1);
            } else {
                nextBillingDate.setFullYear(nextBillingDate.getFullYear() + 1);
            }
            
            // Update user membership
            if (!currentUser.membership) {
                currentUser.membership = {};
            }
            
            currentUser.membership.plan = planId;
            currentUser.membership.subscribedDate = new Date().toISOString();
            currentUser.membership.nextBillingDate = nextBillingDate.toISOString();
            currentUser.membership.paymentMethod = `Credit Card (****${cardNumber.slice(-4)})`;
            currentUser.membership.autoRenew = autoRenew;
            currentUser.membership.status = 'active';
            
            // Add to membership history
            if (!currentUser.membershipHistory) {
                currentUser.membershipHistory = [];
            }
            
            currentUser.membershipHistory.push({
                date: new Date().toISOString(),
                plan: planId,
                amount: plan.price,
                status: 'active'
            });
            
            // Update user in localStorage
            updateUserInStorage(currentUser);
            
            // Close modal
            document.getElementById('subscription-modal').classList.remove('active');
            
            // Show success message
            showNotification(`Successfully subscribed to ${plan.name}!`);
            
            // Reload membership display
            loadCurrentMembership();
        }

        // Cancel membership
        function cancelMembership() {
            if (confirm('Are you sure you want to cancel your membership? You will lose access to premium benefits at the end of your billing period.')) {
                // Update user membership
                currentUser.membership.status = 'cancelled';
                currentUser.membership.cancelledDate = new Date().toISOString();
                
                // Add to membership history
                currentUser.membershipHistory.push({
                    date: new Date().toISOString(),
                    plan: currentUser.membership.plan,
                    amount: 0,
                    status: 'cancelled',
                    note: 'Membership cancelled'
                });
                
                // Update user in localStorage
                updateUserInStorage(currentUser);
                
                // Show confirmation
                showNotification('Your membership has been cancelled. You will retain access until the end of your billing period.');
                
                // Reload membership display
                loadCurrentMembership();
            }
        }

        // Load current membership
        function loadCurrentMembership() {
            if (!currentUser) return;
            
            // Check if user has membership data
            if (currentUser.membership && currentUser.membership.plan && currentUser.membership.status === 'active') {
                // User has a paid membership
                const plan = membershipPlans[currentUser.membership.plan];
                document.getElementById('current-membership').style.display = 'block';
                document.getElementById('membership-plans').style.display = 'none';
                document.getElementById('membership-history').style.display = 'block';
                
                // Update current membership details
                document.getElementById('current-plan-name').textContent = plan.name + ' - ' + 
                    (currentUser.membership.plan.includes('monthly') ? 'Monthly' : 'Yearly');
                document.getElementById('current-plan-price').textContent = 'Rp ' + plan.price.toLocaleString('id-ID');
                document.getElementById('current-plan-period').textContent = currentUser.membership.plan.includes('monthly') ? 'Per Month' : 'Per Year';
                document.getElementById('next-billing-date').textContent = formatDate(currentUser.membership.nextBillingDate);
                document.getElementById('auto-renewal-status').textContent = currentUser.membership.autoRenew ? 'ON' : 'OFF';
                
                // Load membership history
                loadMembershipHistory();
            } else {
                // User has free membership
                document.getElementById('current-membership').style.display = 'none';
                document.getElementById('membership-plans').style.display = 'grid';
                document.getElementById('membership-history').style.display = 'none';
            }
        }

        // Load membership history
        function loadMembershipHistory() {
            if (!currentUser || !currentUser.membershipHistory) return;
            
            const historyBody = document.getElementById('membership-history-body');
            historyBody.innerHTML = '';
            
            currentUser.membershipHistory.forEach(entry => {
                const plan = membershipPlans[entry.plan];
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td style="padding: 10px; border-bottom: 1px solid var(--medium-gray);">${formatDate(entry.date)}</td>
                    <td style="padding: 10px; border-bottom: 1px solid var(--medium-gray);">${plan.name} - ${entry.plan.includes('monthly') ? 'Monthly' : 'Yearly'}</td>
                    <td style="padding: 10px; border-bottom: 1px solid var(--medium-gray);">Rp ${entry.amount.toLocaleString('id-ID')}</td>
                    <td style="padding: 10px; border-bottom: 1px solid var(--medium-gray);">
                        <span class="transaction-status ${entry.status === 'active' ? 'status-success' : 'status-cancelled'}">${entry.status}</span>
                    </td>
                `;
                
                historyBody.appendChild(row);
            });
        }

        // Update user in localStorage
        function updateUserInStorage(user) {
            // Update current user
            localStorage.setItem('currentUser', JSON.stringify(user));
            
            // Update in users array
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            const userIndex = users.findIndex(u => u.id === user.id);
            if (userIndex !== -1) {
                users[userIndex] = user;
                localStorage.setItem('users', JSON.stringify(users));
            }
        }

        // Format date for display
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
        }

        // Show account modal
        function showAccountModal(activeTab = 'profile') {
            // Set active tab
            document.querySelectorAll('.account-tab').forEach(tab => {
                tab.classList.remove('active');
                if (tab.getAttribute('data-tab') === activeTab) {
                    tab.classList.add('active');
                }
            });
            
            document.querySelectorAll('.account-section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(`${activeTab}-section`).classList.add('active');
            
            // Load user data
            if (currentUser) {
                document.getElementById('profile-name').value = currentUser.name || '';
                document.getElementById('profile-email').value = currentUser.email || '';
                document.getElementById('profile-phone').value = currentUser.phone || '';
                document.getElementById('profile-address').value = currentUser.address || '';
                
                // Update points display
                document.getElementById('points-value').textContent = userPoints;
                
                // Load history if needed
                if (activeTab === 'history') {
                    loadTransactionHistory();
                } else if (activeTab === 'points') {
                    loadPointsHistory();
                } else if (activeTab === 'membership') {
                    loadCurrentMembership();
                }
            }
            
            // Show modal
            document.getElementById('account-modal').classList.add('active');
        }

        // Load transaction history
        function loadTransactionHistory() {
            const historyContainer = document.getElementById('transaction-history');
            const orders = JSON.parse(localStorage.getItem('orders') || '[]');
            const userOrders = orders.filter(order => order.customer && order.customer.id === currentUser.id);
            
            if (userOrders.length === 0) {
                historyContainer.innerHTML = '<p>No transaction history found.</p>';
                return;
            }
            
            historyContainer.innerHTML = '';
            
            userOrders.forEach(order => {
                const transactionItem = document.createElement('div');
                transactionItem.className = 'transaction-item';
                
                // Determine status and time since order
                const orderTime = new Date(order.timestamp || Date.now());
                const currentTime = new Date();
                const timeDiff = (currentTime - orderTime) / (1000 * 60 * 60); // Difference in hours
                
                let status = 'success';
                let statusText = 'BERHASIL';
                let statusClass = 'status-success';
                
                // For demo, we'll show some orders as pending
                if (timeDiff < 1) {
                    status = 'pending';
                    statusText = 'SUCCESS';
                    statusClass = 'status-pending';
                }
                
                transactionItem.innerHTML = `
                    <div class="transaction-header">
                        <div class="transaction-id">${order.id}</div>
                        <div class="transaction-status ${statusClass}">${statusText}</div>
                    </div>
                    <div class="transaction-details">
                        <div class="transaction-items">${order.items.length} items</div>
                        <div class="transaction-total">Rp ${order.total.toLocaleString('id-ID')}</div>
                    </div>
                    <div class="transaction-date">${order.date} ${order.time}</div>
                    <div class="transaction-actions">
                        ${status === 'pending' && timeDiff < 1 ? 
                            `<button class="btn btn-outline cancel-order" data-order-id="${order.id}">CANCEL ORDER</button>` : 
                            ''}
                        <button class="btn btn-outline view-order" data-order-id="${order.id}">Lihat Detail</button>
                    </div>
                `;
                
                historyContainer.appendChild(transactionItem);
            });
            
            // Add event listeners for action buttons
            document.querySelectorAll('.cancel-order').forEach(button => {
    button.addEventListener('click', function() {
        const orderId = this.getAttribute('data-order-id');
        // Langsung ubah teks tombol menjadi CANCEL
        this.textContent = 'CANCEL';
        this.disabled = true;
        this.style.backgroundColor = '#f0f0f0';
        this.style.color = '#666';
        cancelOrder(orderId);
    });
});
            
            document.querySelectorAll('.view-order').forEach(button => {
                button.addEventListener('click', function() {
                    const orderId = this.getAttribute('data-order-id');
                    viewOrderDetails(orderId);
                });
            });
        }

        // Load points history
        function loadPointsHistory() {
            const pointsContainer = document.getElementById('points-history');
            const pointsHistory = JSON.parse(localStorage.getItem(`points_history_${currentUser.id}`) || '[]');
            
            if (pointsHistory.length === 0) {
                pointsContainer.innerHTML = '<p>No points history found.</p>';
                return;
            }
            
            pointsContainer.innerHTML = '';
            
            pointsHistory.forEach(entry => {
                const historyItem = document.createElement('div');
                historyItem.className = 'transaction-item';
                historyItem.innerHTML = `
                    <div class="transaction-header">
                        <div>${entry.description}</div>
                        <div class="${entry.points > 0 ? 'status-success' : 'status-cancelled'}">
                            ${entry.points > 0 ? '+' : ''}${entry.points} points
                        </div>
                    </div>
                    <div class="transaction-date">${entry.date}</div>
                `;
                
                pointsContainer.appendChild(historyItem);
            });
        }

        // Cancel order
        function cancelOrder(orderId) {
            if (confirm('Are you sure you want to cancel this order?')) {
                const orders = JSON.parse(localStorage.getItem('orders') || '[]');
                const orderIndex = orders.findIndex(order => order.id === orderId);
                
                if (orderIndex !== -1) {
                    orders[orderIndex].status = 'CANCELLED';
                    localStorage.setItem('orders', JSON.stringify(orders));
                    
                    showNotification('Order cancelled successfully.');
                    loadTransactionHistory();
                }
            }
        }

        // View order details
        function viewOrderDetails(orderId) {
            const orders = JSON.parse(localStorage.getItem('orders') || '[]');
            const order = orders.find(order => order.id === orderId);
            
            if (order) {
                let orderDetails = `Order ID: ${order.id}\n`;
                orderDetails += `Date: ${order.date} ${order.time}\n`;
                orderDetails += `Status: ${order.status || 'COMPLETED'}\n\n`;
                orderDetails += 'Items:\n';
                
                order.items.forEach(item => {
                    orderDetails += `- ${item.name} (${item.quantity}x) - ${item.price}\n`;
                });
                
                orderDetails += `\nTotal: Rp ${order.total.toLocaleString('id-ID')}`;
                
                alert(orderDetails);
            }
        }

        // Update profile
        function updateProfile() {
            const name = document.getElementById('profile-name').value;
            const email = document.getElementById('profile-email').value;
            const phone = document.getElementById('profile-phone').value;
            const address = document.getElementById('profile-address').value;
            
            // Update current user
            currentUser.name = name;
            currentUser.email = email;
            currentUser.phone = phone;
            currentUser.address = address;
            
            // Update localStorage
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            
            // Update users array
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            const userIndex = users.findIndex(u => u.id === currentUser.id);
            if (userIndex !== -1) {
                users[userIndex] = currentUser;
                localStorage.setItem('users', JSON.stringify(users));
            }
            
            showNotification('Profile updated successfully.');
        }

        // Change password
        function changePassword() {
            const currentPassword = document.getElementById('current-password').value;
            const newPassword = document.getElementById('new-password').value;
            const confirmPassword = document.getElementById('confirm-new-password').value;
            
            // Validation
            if (currentPassword !== currentUser.password) {
                alert('Current password is incorrect.');
                return;
            }
            
            if (newPassword !== confirmPassword) {
                alert('New passwords do not match.');
                return;
            }
            
            if (newPassword.length < 6) {
                alert('New password must be at least 6 characters.');
                return;
            }
            
            // Update password
            currentUser.password = newPassword;
            
            // Update localStorage
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            
            // Update users array
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            const userIndex = users.findIndex(u => u.id === currentUser.id);
            if (userIndex !== -1) {
                users[userIndex] = currentUser;
                localStorage.setItem('users', JSON.stringify(users));
            }
            
            document.getElementById('password-form').reset();
            showNotification('Password changed successfully.');
        }

        // Login function
        function login() {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            const rememberMe = document.getElementById('remember-me').checked;

            // Simple validation
            if (!email || !password) {
                showMessage('login-general-error', 'Please fill in all fields');
                return;
            }

            // Get users from localStorage
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            
            // Find user
            const user = users.find(u => u.email === email && u.password === password);
            
            if (user) {
                // Login successful
                currentUser = user;
                
                // Load user points
                const savedPoints = localStorage.getItem(`points_${currentUser.id}`);
                if (savedPoints) {
                    userPoints = parseInt(savedPoints);
                }
                
                // Save to localStorage if remember me is checked
                if (rememberMe) {
                    localStorage.setItem('currentUser', JSON.stringify(user));
                }
                
                // Update UI
                updateUserDisplay();
                
                // Show success message
                showMessage('login-success-message', 'Login successful!');
                
                // Close modal after delay
                setTimeout(() => {
                    document.getElementById('login-modal').classList.remove('active');
                    document.getElementById('login-form').reset();
                    hideMessage('login-success-message');
                }, 1500);
            } else {
                // Login failed
                showMessage('login-general-error', 'Invalid email or password');
            }
        }

        // Register function
        function register() {
            const name = document.getElementById('register-name').value;
            const email = document.getElementById('register-email').value;
            const password = document.getElementById('register-password').value;
            const confirm = document.getElementById('register-confirm').value;

            // Validation
            if (!name || !email || !password || !confirm) {
                showMessage('register-general-error', 'Please fill in all fields');
                return;
            }

            if (password !== confirm) {
                showMessage('register-confirm-error', 'Passwords do not match');
                return;
            }

            if (password.length < 6) {
                showMessage('register-password-error', 'Password must be at least 6 characters');
                return;
            }

            // Get users from localStorage
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            
            // Check if user already exists
            if (users.find(u => u.email === email)) {
                showMessage('register-email-error', 'Email already registered');
                return;
            }

            // Create new user
            const newUser = {
                id: Date.now(),
                name: name,
                email: email,
                password: password
            };

            // Save user
            users.push(newUser);
            localStorage.setItem('users', JSON.stringify(users));

            // Show verification message (simulated)
            showMessage('register-success-message', 'Registration successful! Please check your email for verification.');
            
            // Close modal after delay
            setTimeout(() => {
                document.getElementById('register-modal').classList.remove('active');
                document.getElementById('register-form').reset();
                hideMessage('register-success-message');
                
                // Auto login after verification (simulated)
                setTimeout(() => {
                    currentUser = newUser;
                    updateUserDisplay();
                    showNotification('Email verified! You are now logged in.');
                }, 2000);
            }, 2000);
        }

        // Google login function (simulated)
        function googleLogin() {
            // Simulate Google login
            const googleUser = {
                id: Date.now(),
                name: 'Google User',
                email: 'user@gmail.com',
                isGoogleUser: true
            };
            
            currentUser = googleUser;
            localStorage.setItem('currentUser', JSON.stringify(googleUser));
            updateUserDisplay();
            
            document.getElementById('login-modal').classList.remove('active');
            showNotification('Logged in with Google successfully!');
        }

        // Google register function (simulated)
        function googleRegister() {
            // Simulate Google registration
            const googleUser = {
                id: Date.now(),
                name: 'Google User',
                email: 'user@gmail.com',
                isGoogleUser: true
            };
            
            // Save user to localStorage
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            users.push(googleUser);
            localStorage.setItem('users', JSON.stringify(users));
            
            currentUser = googleUser;
            localStorage.setItem('currentUser', JSON.stringify(googleUser));
            updateUserDisplay();
            
            document.getElementById('register-modal').classList.remove('active');
            showNotification('Registered with Google successfully!');
        }

        // Forgot password function
        function forgotPassword() {
            const email = document.getElementById('forgot-password-email').value;

            if (!email) {
                showMessage('forgot-password-email-error', 'Please enter your email');
                return;
            }

            // Get users from localStorage
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            
            // Check if email exists
            if (users.find(u => u.email === email)) {
                // In a real app, you would send an email here
                showMessage('forgot-password-success-message', 'Password reset link has been sent to your email');
                
                // Close modal after delay
                setTimeout(() => {
                    document.getElementById('forgot-password-modal').classList.remove('active');
                    document.getElementById('forgot-password-form').reset();
                    hideMessage('forgot-password-success-message');
                }, 2000);
            } else {
                showMessage('forgot-password-email-error', 'Email not found');
            }
        }

        // Logout function
        function logout() {
            currentUser = null;
            userPoints = 0;
            localStorage.removeItem('currentUser');
            updateUserDisplay();
            document.getElementById('user-dropdown').classList.remove('active');
            showNotification('You have been logged out successfully.');
        }

        // Update user display
        function updateUserDisplay() {
            const userIcon = document.getElementById('user-icon');
            if (currentUser) {
                userIcon.className = 'fas fa-user-check';
                userIcon.style.color = 'var(--yellow)';
            } else {
                userIcon.className = 'fas fa-user';
                userIcon.style.color = '';
            }
        }

        // Show message function
        function showMessage(elementId, message) {
            const element = document.getElementById(elementId);
            element.textContent = message;
            element.style.display = 'block';
        }

        // Hide message function
        function hideMessage(elementId) {
            const element = document.getElementById(elementId);
            element.style.display = 'none';
        }

        // Populate flash sale products
        function populateFlashSale() {
            const flashSaleContainer = document.getElementById('flash-sale-products');
            
            // Get first 4 products from all categories for flash sale
            let flashSaleProducts = [];
            productsData.categories.forEach(category => {
                flashSaleProducts = flashSaleProducts.concat(category.products.slice(0, 2));
            });
            
            flashSaleProducts = flashSaleProducts.slice(0, 4);
            
            flashSaleProducts.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                
                productCard.innerHTML = `
                    <div class="product-badge">FLASH SALE</div>
                    <div class="product-img">
                        <img src="${product.image}" alt="${product.name}" onerror="this.innerHTML='[${product.name} Image]'">
                    </div>
                    <div class="product-content">
                        <h3>${product.name}</h3>
                        <p class="product-description">${product.description.substring(0, 100)}...</p>
                        <div class="product-price">${product.price}</div>
                        <div class="product-wholesale">${product.wholesale}</div>
                        <div class="product-actions">
                            <button class="btn-outline view-details" data-id="${product.id}">View Details</button>
                            <div class="quick-add" data-id="${product.id}">
                                <i class="fas fa-plus"></i>
                            </div>
                        </div>
                    </div>
                `;
                
                flashSaleContainer.appendChild(productCard);
            });
            
            // Add event listeners to view details buttons
            document.querySelectorAll('.view-details').forEach(button => {
                button.addEventListener('click', function() {
                    const productId = this.getAttribute('data-id');
                    showProductDetail(productId);
                });
            });
        }


        // Populate categories and products
        function populateCategories() {
            const categoryFilter = document.getElementById('category-filter');
            const categoryProducts = document.getElementById('category-products');
            
            // Add "All" category button
            const allButton = document.createElement('button');
            allButton.className = 'category-btn active';
            allButton.textContent = 'All';
            allButton.setAttribute('data-category', 'all');
            allButton.addEventListener('click', function() {
                // Update active category
                document.querySelectorAll('.category-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                this.classList.add('active');
                
                // Show all products
                currentCategory = 'all';
                displayCategoryProducts('all');
            });
            categoryFilter.appendChild(allButton);
            
            // Add category buttons
            productsData.categories.forEach(category => {
                const button = document.createElement('button');
                button.className = 'category-btn';
                button.textContent = category.name;
                button.setAttribute('data-category', category.id);
                button.addEventListener('click', function() {
                    // Update active category
                    document.querySelectorAll('.category-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    this.classList.add('active');
                    
                    // Show category products
                    currentCategory = category.id;
                    displayCategoryProducts(category.id);
                });
                categoryFilter.appendChild(button);
            });
            
            // Display all products initially
            displayCategoryProducts('all');
        }

        // Display products for a category
        function displayCategoryProducts(categoryId) {
            const categoryProducts = document.getElementById('category-products');
            categoryProducts.innerHTML = '';
            
            let productsToShow = [];
            
            if (categoryId === 'all') {
                // Show all products
                productsData.categories.forEach(category => {
                    productsToShow = productsToShow.concat(category.products);
                });
            } else {
                // Show products from specific category
                const category = productsData.categories.find(cat => cat.id === categoryId);
                if (category) {
                    productsToShow = category.products;
                }
            }
            
            productsToShow.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                
                productCard.innerHTML = `
                    <div class="product-img">
                        <img src="${product.image}" alt="${product.name}" onerror="this.innerHTML='[${product.name} Image]'">
                    </div>
                    <div class="product-content">
                        <h3>${product.name}</h3>
                        <p class="product-description">${product.description.substring(0, 100)}...</p>
                        <div class="product-price">${product.price}</div>
                        <div class="product-wholesale">${product.wholesale}</div>
                        <div class="product-actions">
                            <button class="btn-outline view-details" data-id="${product.id}">View Details</button>
                            <div class="quick-add" data-id="${product.id}">
                                <i class="fas fa-plus"></i>
                            </div>
                        </div>
                    </div>
                `;
                
                categoryProducts.appendChild(productCard);
            });
            
            // Add event listeners to view details buttons
            document.querySelectorAll('.view-details').forEach(button => {
                button.addEventListener('click', function() {
                    const productId = this.getAttribute('data-id');
                    showProductDetail(productId);
                });
            });
        }

        // Initialize cart functionality
        function initCart() {
            const cartIcon = document.querySelector('.cart-icon');
            const cartDrawer = document.getElementById('cart-drawer');
            const closeCart = document.getElementById('close-cart');
            const cartItems = document.getElementById('cart-items');
            const cartCount = document.querySelector('.cart-count');
            const cartSubtotal = document.getElementById('cart-subtotal-price');
            const checkoutBtn = document.getElementById('checkout-btn');
            
            // Open cart drawer
            cartIcon.addEventListener('click', function() {
                cartDrawer.classList.add('active');
                updateCartDisplay();
            });
            
            // Close cart drawer
            closeCart.addEventListener('click', function() {
                cartDrawer.classList.remove('active');
            });
            
            // Checkout button
            checkoutBtn.addEventListener('click', function() {
                if (cart.length === 0) {
                    alert('Your cart is empty!');
                    return;
                }
                
                // Check if user is logged in
                if (!currentUser) {
                    // Show login required message
                    document.getElementById('login-required-message').classList.add('active');
                    cartDrawer.classList.remove('active');
                    return;
                }
                
                // Start checkout process
                startCheckout();
            });
            
            // Add to cart functionality
            document.addEventListener('click', function(e) {
                if (e.target.closest('.quick-add')) {
                    const itemId = e.target.closest('.quick-add').getAttribute('data-id');
                    addToCart(itemId);
                }
            });
            
            // Update cart count
            function updateCartCount() {
                const totalItems = cart.reduce((total, item) => total + item.quantity, 0);
                cartCount.textContent = totalItems;
            }
            
            // Update cart display
            function updateCartDisplay() {
                cartItems.innerHTML = '';
                let subtotal = 0;
                
                cart.forEach(item => {
                    // Extract numeric value from price string for calculation
                    const priceValue = parseInt(item.price.replace(/[^\d]/g, ''));
                    subtotal += priceValue * item.quantity;
                    
                    const cartItem = document.createElement('div');
                    cartItem.className = 'cart-item';
                    cartItem.innerHTML = `
                        <div class="cart-item-img">
                            <img src="${item.image}" alt="${item.name}" onerror="this.innerHTML='[Product Image]'">
                        </div>
                        <div class="cart-item-details">
                            <div class="cart-item-title">${item.name}</div>
                            <div class="cart-item-price">${item.price}</div>
                            <div class="cart-item-actions">
                                <div class="quantity-control">
                                    <button class="quantity-btn minus" data-id="${item.id}">-</button>
                                    <span class="quantity">${item.quantity}</span>
                                    <button class="quantity-btn plus" data-id="${item.id}">+</button>
                                </div>
                                <button class="cart-item-remove" data-id="${item.id}">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    `;
                    
                    cartItems.appendChild(cartItem);
                });
                
                // Format subtotal as Rupiah
                cartSubtotal.textContent = `Rp ${subtotal.toLocaleString('id-ID')}`;
                
                // Add event listeners to quantity buttons
                document.querySelectorAll('.quantity-btn.minus').forEach(button => {
                    button.addEventListener('click', function() {
                        const id = this.getAttribute('data-id');
                        const item = cart.find(item => item.id == id);
                        
                        if (item.quantity > 1) {
                            item.quantity -= 1;
                        } else {
                            cart = cart.filter(item => item.id != id);
                        }
                        
                        updateCartCount();
                        updateCartDisplay();
                    });
                });
                
                document.querySelectorAll('.quantity-btn.plus').forEach(button => {
                    button.addEventListener('click', function() {
                        const id = this.getAttribute('data-id');
                        const item = cart.find(item => item.id == id);
                        item.quantity += 1;
                        
                        updateCartCount();
                        updateCartDisplay();
                    });
                });
                
                document.querySelectorAll('.cart-item-remove').forEach(button => {
                    button.addEventListener('click', function() {
                        const id = this.getAttribute('data-id');
                        cart = cart.filter(item => item.id != id);
                        
                        updateCartCount();
                        updateCartDisplay();
                    });
                });
            }
            
            // Add product to cart
            function addToCart(productId) {
                // Find product in all categories
                let product = null;
                for (const category of productsData.categories) {
                    product = category.products.find(p => p.id == productId);
                    if (product) break;
                }
                
                if (!product) return;
                
                // Check if item is already in cart
                const existingItem = cart.find(cartItem => cartItem.id == productId);
                
                if (existingItem) {
                    existingItem.quantity += 1;
                } else {
                    cart.push({
                        id: product.id,
                        name: product.name,
                        price: product.price,
                        image: product.image,
                        quantity: 1
                    });
                }
                
                updateCartCount();
                updateCartDisplay();
                
                // Show notification
                showNotification(`${product.name} added to cart`);
            }
        }

        // Initialize checkout process
        function initCheckout() {
            const closeCheckout = document.getElementById('close-checkout');
            const cancelCheckout = document.getElementById('cancel-checkout');
            const toShipping = document.getElementById('to-shipping');
            const backToAddress = document.getElementById('back-to-address');
            const toPayment = document.getElementById('to-payment');
            const backToShipping = document.getElementById('back-to-shipping');
            const toConfirmation = document.getElementById('to-confirmation');
            const backToPayment = document.getElementById('back-to-payment');
            const placeOrder = document.getElementById('place-order');
            const addNewAddress = document.getElementById('add-new-address');
            const closeQrPayment = document.getElementById('close-qr-payment');
            const simulatePayment = document.getElementById('simulate-payment');
            const closePaymentSuccess = document.getElementById('close-payment-success');
            const downloadReceipt = document.getElementById('download-receipt');
            
            // Close checkout modal
            closeCheckout.addEventListener('click', function() {
                document.getElementById('checkout-modal').classList.remove('active');
                resetCheckout();
            });
            
            // Cancel checkout
            cancelCheckout.addEventListener('click', function() {
                document.getElementById('checkout-modal').classList.remove('active');
                resetCheckout();
            });
            
            // Navigate to shipping step
            toShipping.addEventListener('click', function() {
                if (!checkoutData.address) {
                    alert('Please select an address');
                    return;
                }
                navigateToStep(2);
                populateOutletOptions();
                populateShippingOptions();
                populateOrderSummary();
            });
            
            // Navigate back to address step
            backToAddress.addEventListener('click', function() {
                navigateToStep(1);
            });
            
            // Navigate to payment step
            toPayment.addEventListener('click', function() {
                if (!checkoutData.outlet) {
                    alert('Please select an outlet');
                    return;
                }
                if (!checkoutData.shipping) {
                    alert('Please select a shipping method');
                    return;
                }
                navigateToStep(3);
                populatePaymentOptions();
            });
            
            // Navigate back to shipping step
            backToShipping.addEventListener('click', function() {
                navigateToStep(2);
            });
            
            // Navigate to confirmation step
            toConfirmation.addEventListener('click', function() {
                if (!checkoutData.payment) {
                    alert('Please select a payment method');
                    return;
                }
                navigateToStep(4);
                populateOrderConfirmation();
            });
            
            // Navigate back to payment step
            backToPayment.addEventListener('click', function() {
                navigateToStep(3);
            });
            
            // Place order with QR Code
            placeOrder.addEventListener('click', function() {
                showQRPayment();
            });
            
            // Add new address
            addNewAddress.addEventListener('click', function() {
                addNewAddressForm();
            });
            
            // Close QR payment modal
            closeQrPayment.addEventListener('click', function() {
                document.getElementById('qr-payment-modal').classList.remove('active');
            });
            
            // Simulate payment
            simulatePayment.addEventListener('click', function() {
                processPaymentSuccess();
            });
            
            // Close payment success modal
            closePaymentSuccess.addEventListener('click', function() {
                document.getElementById('payment-success-modal').classList.remove('active');
            });
            
            // Download receipt
            downloadReceipt.addEventListener('click', function() {
                downloadReceiptPDF();
            });
            
            // Close modals when clicking outside
            window.addEventListener('click', function(e) {
                if (e.target === document.getElementById('checkout-modal')) {
                    document.getElementById('checkout-modal').classList.remove('active');
                    resetCheckout();
                }
                if (e.target === document.getElementById('qr-payment-modal')) {
                    document.getElementById('qr-payment-modal').classList.remove('active');
                }
                if (e.target === document.getElementById('payment-success-modal')) {
                    document.getElementById('payment-success-modal').classList.remove('active');
                }
            });
        }
        
        // Start checkout process
        function startCheckout() {
            // Reset checkout data
            checkoutData = {
                address: null,
                outlet: null,
                shipping: null,
                payment: null,
                voucher: null,
                orderTempId: 'FAF-' + Date.now()
            };
            
            // Reset applied voucher
            appliedVoucher = null;
            
            // Close cart drawer
            document.getElementById('cart-drawer').classList.remove('active');
            
            // Show checkout modal
            document.getElementById('checkout-modal').classList.add('active');
            
            // Initialize first step
            navigateToStep(1);
            populateAddresses();
        }
        
        // Navigate to specific checkout step
        function navigateToStep(step) {
            // Update step indicators
            document.querySelectorAll('.checkout-step').forEach(stepEl => {
                stepEl.classList.remove('active', 'completed');
            });
            
            for (let i = 1; i <= step; i++) {
                const stepEl = document.querySelector(`.checkout-step[data-step="${i}"]`);
                if (i === step) {
                    stepEl.classList.add('active');
                } else {
                    stepEl.classList.add('completed');
                }
            }
            
            // Show corresponding section
            document.querySelectorAll('.checkout-section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(`checkout-${getStepName(step)}`).classList.add('active');
        }
        
        // Get step name by number
        function getStepName(step) {
            switch(step) {
                case 1: return 'address';
                case 2: return 'shipping';
                case 3: return 'payment';
                case 4: return 'confirmation';
                default: return 'address';
            }
        }
        
        // Populate addresses
        function populateAddresses() {
            const addressList = document.getElementById('address-list');
            addressList.innerHTML = '';
            
            // Get addresses from user data or use defaults
            const addresses = currentUser.addresses || [
                {
                    id: 1,
                    name: 'Rumah',
                    recipient: currentUser.name,
                    street: 'Jl. Merdeka No. 123',
                    city: 'Jakarta Pusat',
                    province: 'DKI Jakarta',
                    postalCode: '10110',
                    phone: '081234567890',
                    isDefault: true
                },
                {
                    id: 2,
                    name: 'Kantor',
                    recipient: currentUser.name,
                    street: 'Jl. Sudirman No. 456',
                    city: 'Jakarta Selatan',
                    province: 'DKI Jakarta',
                    postalCode: '12190',
                    phone: '081234567890',
                    isDefault: false
                }
            ];
            
            addresses.forEach(address => {
                const addressCard = document.createElement('div');
                addressCard.className = 'address-card';
                if (address.isDefault) {
                    addressCard.classList.add('selected');
                    checkoutData.address = address;
                }
                addressCard.innerHTML = `
                    <div class="address-name">${address.name} ${address.isDefault ? '(Default)' : ''}</div>
                    <div class="address-details">
                        <div>${address.recipient} | ${address.phone}</div>
                        <div>${address.street}, ${address.city}, ${address.province} ${address.postalCode}</div>
                    </div>
                `;
                addressCard.addEventListener('click', function() {
                    document.querySelectorAll('.address-card').forEach(card => {
                        card.classList.remove('selected');
                    });
                    this.classList.add('selected');
                    checkoutData.address = address;
                });
                addressList.appendChild(addressCard);
            });
        }
        
        // Populate outlet options
        function populateOutletOptions() {
            const outletList = document.getElementById('outlet-list');
            outletList.innerHTML = '';
            
            outlets.forEach(outlet => {
                const outletItem = document.createElement('div');
                outletItem.className = 'outlet-item';
                outletItem.innerHTML = `
                    <div>${outlet}</div>
                `;
                outletItem.addEventListener('click', function() {
                    document.querySelectorAll('.outlet-item').forEach(item => {
                        item.classList.remove('selected');
                    });
                    this.classList.add('selected');
                    checkoutData.outlet = outlet;
                });
                outletList.appendChild(outletItem);
            });
        }
        
        // Populate shipping options
        function populateShippingOptions() {
            const shippingOptions = document.getElementById('shipping-options');
            shippingOptions.innerHTML = '';
            
            const options = [
                { id: 'jne-reg', name: 'JNE REG', cost: 15000, estimate: '2-3 hari' },
                { id: 'jne-oke', name: 'JNE OKE', cost: 12000, estimate: '3-5 hari' },
                { id: 'tiki-reg', name: 'TIKI REG', cost: 16000, estimate: '2-3 hari' },
                { id: 'pos-kilo', name: 'POS Indonesia', cost: 10000, estimate: '4-7 hari' }
            ];
            
            options.forEach(option => {
                const shippingCard = document.createElement('div');
                shippingCard.className = 'payment-card';
                shippingCard.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <div style="font-weight: 600;">${option.name}</div>
                            <div style="font-size: 14px; color: var(--dark-gray);">Estimasi: ${option.estimate}</div>
                        </div>
                        <div style="font-weight: 600;">Rp ${option.cost.toLocaleString('id-ID')}</div>
                    </div>
                `;
                shippingCard.addEventListener('click', function() {
                    document.querySelectorAll('.payment-card').forEach(card => {
                        card.classList.remove('selected');
                    });
                    this.classList.add('selected');
                    checkoutData.shipping = option;
                });
                shippingOptions.appendChild(shippingCard);
            });
        }
        
        // Populate order summary
        function populateOrderSummary() {
            const orderSummaryItems = document.getElementById('order-summary-items');
            const orderTotal = document.getElementById('order-total');
            
            orderSummaryItems.innerHTML = '';
            let subtotal = 0;
            
            cart.forEach(item => {
                const priceValue = parseInt(item.price.replace(/[^\d]/g, ''));
                const itemTotal = priceValue * item.quantity;
                subtotal += itemTotal;
                
                const summaryItem = document.createElement('div');
                summaryItem.className = 'order-summary-item';
                summaryItem.innerHTML = `
                    <span>${item.name} (${item.quantity}x)</span>
                    <span>Rp ${itemTotal.toLocaleString('id-ID')}</span>
                `;
                orderSummaryItems.appendChild(summaryItem);
            });
            
            // Add shipping cost if selected
            let total = subtotal;
            if (checkoutData.shipping) {
                const shippingItem = document.createElement('div');
                shippingItem.className = 'order-summary-item';
                shippingItem.innerHTML = `
                    <span>Ongkos Kirim (${checkoutData.shipping.name})</span>
                    <span>Rp ${checkoutData.shipping.cost.toLocaleString('id-ID')}</span>
                `;
                orderSummaryItems.appendChild(shippingItem);
                total += checkoutData.shipping.cost;
            }
            
            // Apply voucher discount if available
            let discount = 0;
            if (appliedVoucher) {
                if (appliedVoucher.type === 'percentage') {
                    discount = (subtotal * appliedVoucher.discount) / 100;
                } else {
                    discount = appliedVoucher.discount;
                }
                
                const discountItem = document.createElement('div');
                discountItem.className = 'order-summary-item';
                discountItem.innerHTML = `
                    <span>Diskon Voucher (${appliedVoucher.name})</span>
                    <span style="color: var(--medium-green);">- Rp ${discount.toLocaleString('id-ID')}</span>
                `;
                orderSummaryItems.appendChild(discountItem);
                total -= discount;
            }
            
            orderTotal.textContent = `Rp ${total.toLocaleString('id-ID')}`;
        }
        
        // Populate payment options
        function populatePaymentOptions() {
            const paymentOptions = document.getElementById('payment-options');
            paymentOptions.innerHTML = '';
            
            // Only show QR Code payment
            const option = { id: 'qr-code', name: 'QR Code Payment', icon: 'fas fa-qrcode' };
            
            const paymentCard = document.createElement('div');
            paymentCard.className = 'payment-card selected';
            paymentCard.innerHTML = `
                <div style="display: flex; align-items: center; gap: 10px;">
                    <i class="${option.icon}"></i>
                    <div>${option.name}</div>
                </div>
            `;
            paymentCard.addEventListener('click', function() {
                document.querySelectorAll('.payment-card').forEach(card => {
                    card.classList.remove('selected');
                });
                this.classList.add('selected');
                checkoutData.payment = option;
            });
            paymentOptions.appendChild(paymentCard);
            
            // Automatically set to QR Code
            checkoutData.payment = option;
        }
        
        // Populate order confirmation
        function populateOrderConfirmation() {
            const orderConfirmationDetails = document.getElementById('order-confirmation-details');
            
            // Calculate totals
            let subtotal = 0;
            cart.forEach(item => {
                const priceValue = parseInt(item.price.replace(/[^\d]/g, ''));
                subtotal += priceValue * item.quantity;
            });
            
            const shippingCost = checkoutData.shipping ? checkoutData.shipping.cost : 0;
            let discount = 0;
            
            if (appliedVoucher) {
                if (appliedVoucher.type === 'percentage') {
                    discount = (subtotal * appliedVoucher.discount) / 100;
                } else {
                    discount = appliedVoucher.discount;
                }
            }
            
            const total = subtotal + shippingCost - discount;
            
            orderConfirmationDetails.innerHTML = `
                <div style="margin-bottom: 20px;">
                    <h4>Alamat Pengiriman</h4>
                    <div>${checkoutData.address.recipient} | ${checkoutData.address.phone}</div>
                    <div>${checkoutData.address.street}, ${checkoutData.address.city}, ${checkoutData.address.province} ${checkoutData.address.postalCode}</div>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4>Outlet Pengiriman</h4>
                    <div>${checkoutData.outlet}</div>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4>Metode Pengiriman</h4>
                    <div>${checkoutData.shipping.name} - Rp ${checkoutData.shipping.cost.toLocaleString('id-ID')}</div>
                    <div>Estimasi: ${checkoutData.shipping.estimate}</div>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4>Metode Pembayaran</h4>
                    <div>${checkoutData.payment.name}</div>
                </div>
                
                ${appliedVoucher ? `
                <div style="margin-bottom: 20px;">
                    <h4>Voucher Yang Digunakan</h4>
                    <div>${appliedVoucher.name} - ${appliedVoucher.type === 'percentage' ? appliedVoucher.discount + '%' : 'Rp ' + appliedVoucher.discount.toLocaleString('id-ID')}</div>
                </div>
                ` : ''}
                
                <div style="margin-bottom: 20px;">
                    <h4>Ringkasan Pesanan</h4>
                    ${cart.map(item => {
                        const priceValue = parseInt(item.price.replace(/[^\d]/g, ''));
                        const itemTotal = priceValue * item.quantity;
                        return `<div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span>${item.name} (${item.quantity}x)</span>
                            <span>Rp ${itemTotal.toLocaleString('id-ID')}</span>
                        </div>`;
                    }).join('')}
                    <div style="display: flex; justify-content: space-between; margin-top: 10px; border-top: 1px solid var(--medium-gray); padding-top: 10px;">
                        <span>Subtotal:</span>
                        <span>Rp ${subtotal.toLocaleString('id-ID')}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span>Ongkos Kirim:</span>
                        <span>Rp ${shippingCost.toLocaleString('id-ID')}</span>
                    </div>
                    ${appliedVoucher ? `
                    <div style="display: flex; justify-content: space-between;">
                        <span>Diskon Voucher:</span>
                        <span style="color: var(--medium-green);">- Rp ${discount.toLocaleString('id-ID')}</span>
                    </div>
                    ` : ''}
                    <div style="display: flex; justify-content: space-between; font-weight: 600; font-size: 18px; margin-top: 10px;">
                        <span>Total:</span>
                        <span>Rp ${total.toLocaleString('id-ID')}</span>
                    </div>
                </div>
            `;
        }
        
        // Show QR payment modal
        function showQRPayment() {
            // Calculate totals
            let subtotal = 0;
            cart.forEach(item => {
                const priceValue = parseInt(item.price.replace(/[^\d]/g, ''));
                subtotal += priceValue * item.quantity;
            });
            
            const shippingCost = checkoutData.shipping ? checkoutData.shipping.cost : 0;
            let discount = 0;
            
            if (appliedVoucher) {
                if (appliedVoucher.type === 'percentage') {
                    discount = (subtotal * appliedVoucher.discount) / 100;
                } else {
                    discount = appliedVoucher.discount;
                }
            }
            
            const total = subtotal + shippingCost - discount;
            
            // Create order object
            currentOrder = {
                id: checkoutData.orderTempId,
                date: new Date().toLocaleDateString('id-ID'),
                time: new Date().toLocaleTimeString('id-ID'),
                timestamp: new Date().getTime(),
                items: [...cart],
                address: checkoutData.address,
                outlet: checkoutData.outlet,
                shipping: checkoutData.shipping,
                payment: checkoutData.payment,
                voucher: appliedVoucher,
                subtotal: subtotal,
                shippingCost: shippingCost,
                discount: discount,
                total: total,
                customer: currentUser,
                status: 'PENDING'
            };
            
            // Generate QR Code URL
            const qrContent = `INVOICE: ${currentOrder.id}\nTOTAL: Rp ${currentOrder.total.toLocaleString('id-ID')}\nTOKO: FreshAndFix`;
            const qrURL = "https://chart.googleapis.com/chart?cht=qr&chs=300x300&chl=" + encodeURIComponent(qrContent);
            
            // Set QR Code image
            document.getElementById('qr-code-image').src = qrURL;
            
            // Show QR payment modal
            document.getElementById('checkout-modal').classList.remove('active');
            document.getElementById('qr-payment-modal').classList.add('active');
            
            // Start countdown
            let countdown = 5;
            document.getElementById('countdown').textContent = countdown;
            
            const countdownInterval = setInterval(() => {
                countdown--;
                document.getElementById('countdown').textContent = countdown;
                
                if (countdown <= 0) {
                    clearInterval(countdownInterval);
                    processPaymentSuccess();
                }
            }, 1000);
        }
        
        // Process payment success
        function processPaymentSuccess() {
            // Close QR payment modal
            document.getElementById('qr-payment-modal').classList.remove('active');
            
            // Update order status
            currentOrder.status = 'SUCCESS';
            
            // Save order to localStorage
            const orders = JSON.parse(localStorage.getItem('orders') || '[]');
            orders.push(currentOrder);
            localStorage.setItem('orders', JSON.stringify(orders));
            
            // Calculate and award points (1 point per Rp 20,000)
            const pointsEarned = Math.floor(currentOrder.total / 20000);
            if (pointsEarned > 0) {
                userPoints += pointsEarned;
                localStorage.setItem(`points_${currentUser.id}`, userPoints.toString());
                
                // Save points history
                const pointsHistory = JSON.parse(localStorage.getItem(`points_history_${currentUser.id}`) || '[]');
                pointsHistory.push({
                    date: currentOrder.date,
                    description: `Pembelian ${currentOrder.id}`,
                    points: pointsEarned
                });
                localStorage.setItem(`points_history_${currentUser.id}`, JSON.stringify(pointsHistory));
            }
            
            // Clear cart
            cart = [];
            updateCartCount();
            updateCartDisplay();
            
            // Show success modal
            document.getElementById('payment-success-modal').classList.add('active');
            
            // Show notification
            showNotification(`Pembayaran berhasil! Anda mendapatkan ${pointsEarned} poin.`);
        }
        
        // Download receipt as PDF
        function downloadReceiptPDF() {
            if (!currentOrder) return;
            
            // Create receipt HTML for PDF
            const receiptHTML = `
                <div id="receipt-pdf" style="width: 80mm; padding: 10px; font-family: Arial, sans-serif; font-size: 12px; line-height: 1.2;">
                    <!-- Header -->
                    <div style="text-align: center; margin-bottom: 10px;">
                        <h2 style="font-size: 16px; font-weight: bold; margin: 0;">FRESHANDFIX</h2>
                        <p style="margin: 2px 0; font-size: 10px;">Fresh Groceries, Fixed Prices, Fast Delivery</p>
                        <div style="border-bottom: 1px dashed #000; margin: 5px 0;"></div>
                    </div>
                    
                    <!-- Order Info -->
                    <div style="margin-bottom: 10px;">
                        <p style="margin: 2px 0;"><strong>Order ID:</strong> ${currentOrder.id}</p>
                        <p style="margin: 2px 0;"><strong>Date:</strong> ${currentOrder.date}</p>
                        <p style="margin: 2px 0;"><strong>Customer:</strong> ${currentOrder.customer.name}</p>
                    </div>
                    
                    <div style="border-bottom: 1px dashed #000; margin: 5px 0;"></div>
                    
                    <!-- Items -->
                    <div style="margin-bottom: 10px;">
                        <table style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr>
                                    <th style="text-align: left; padding: 2px 0; border-bottom: 1px dotted #ccc;">Item</th>
                                    <th style="text-align: center; padding: 2px 0; border-bottom: 1px dotted #ccc;">Qty</th>
                                    <th style="text-align: right; padding: 2px 0; border-bottom: 1px dotted #ccc;">Price</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${currentOrder.items.map(item => {
                                    const priceValue = parseInt(item.price.replace(/[^\d]/g, ''));
                                    const itemTotal = priceValue * item.quantity;
                                    return `
                                        <tr>
                                            <td style="padding: 3px 0; border-bottom: 1px dotted #eee;">${item.name}</td>
                                            <td style="text-align: center; padding: 3px 0; border-bottom: 1px dotted #eee;">${item.quantity}</td>
                                            <td style="text-align: right; padding: 3px 0; border-bottom: 1px dotted #eee;">Rp ${itemTotal.toLocaleString('id-ID')}</td>
                                        </tr>
                                    `;
                                }).join('')}
                            </tbody>
                        </table>
                    </div>
                    
                    <div style="border-bottom: 1px dashed #000; margin: 5px 0;"></div>
                    
                    <!-- Total -->
                    <div style="text-align: right; margin-bottom: 10px;">
                        <p style="margin: 5px 0; font-size: 14px; font-weight: bold;">
                            TOTAL: Rp ${currentOrder.total.toLocaleString('id-ID')}
                        </p>
                    </div>
                    
                    <!-- Payment Details -->
                    <div style="margin-bottom: 10px;">
                        <p style="margin: 2px 0;"><strong>Payment Method:</strong> ${currentOrder.payment.name}</p>
                    </div>
                    
                    <div style="border-bottom: 1px dashed #000; margin: 5px 0;"></div>
                    
                    <!-- Thank You Message -->
                    <div style="text-align: center; margin: 10px 0;">
                        <p style="margin: 2px 0; font-size: 10px;">Thank you for your purchase!</p>
                        <p style="margin: 2px 0; font-size: 10px;">We appreciate your support.</p>
                        <p style="margin: 2px 0; font-size: 10px;">Visit us again at freshandfix.com</p>
                    </div>
                </div>
            `;
            
            // Create temporary element for receipt
            const tempElement = document.createElement('div');
            tempElement.innerHTML = receiptHTML;
            document.body.appendChild(tempElement);
            
            // Use html2canvas to convert receipt to image
            html2canvas(tempElement.querySelector('#receipt-pdf'), {
                scale: 3, // Higher scale for better quality
                useCORS: true,
                logging: false
            }).then(canvas => {
                // Convert canvas to image data URL
                const imageData = canvas.toDataURL('image/png');
                
                // Create download link
                const link = document.createElement('a');
                link.href = imageData;
                link.download = `receipt-${currentOrder.id}.png`;
                link.click();
                
                // Clean up
                document.body.removeChild(tempElement);
            });
        }
        
        // Add new address form
        function addNewAddressForm() {
            const addressList = document.getElementById('address-list');
            const newAddressForm = document.createElement('div');
            newAddressForm.className = 'address-card';
            newAddressForm.innerHTML = `
                <h4>Tambah Alamat Baru</h4>
                <div class="form-group">
                    <label for="new-address-name">Nama Alamat</label>
                    <input type="text" id="new-address-name" placeholder="Rumah / Kantor">
                </div>
                <div class="form-group">
                    <label for="new-address-recipient">Nama Penerima</label>
                    <input type="text" id="new-address-recipient" value="${currentUser.name}">
                </div>
                <div class="form-group">
                    <label for="new-address-phone">Nomor Telepon</label>
                    <input type="text" id="new-address-phone" placeholder="081234567890">
                </div>
                <div class="form-group">
                    <label for="new-address-street">Alamat Lengkap</label>
                    <input type="text" id="new-address-street" placeholder="Jl. Contoh No. 123">
                </div>
                <div class="form-group">
                    <label for="new-address-city">Kota</label>
                    <input type="text" id="new-address-city" placeholder="Jakarta Pusat">
                </div>
                <div class="form-group">
                    <label for="new-address-province">Provinsi</label>
                    <input type="text" id="new-address-province" placeholder="DKI Jakarta">
                </div>
                <div class="form-group">
                    <label for="new-address-postal">Kode Pos</label>
                    <input type="text" id="new-address-postal" placeholder="10110">
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="new-address-default"> Jadikan alamat default
                    </label>
                </div>
                <div class="checkout-actions">
                    <button class="btn btn-secondary" id="cancel-new-address">Batal</button>
                    <button class="btn btn-primary" id="save-new-address">Simpan</button>
                </div>
            `;
            addressList.appendChild(newAddressForm);
            
            // Event listeners for new address form
            document.getElementById('cancel-new-address').addEventListener('click', function() {
                newAddressForm.remove();
            });
            
            document.getElementById('save-new-address').addEventListener('click', function() {
                const newAddress = {
                    id: Date.now(),
                    name: document.getElementById('new-address-name').value,
                    recipient: document.getElementById('new-address-recipient').value,
                    phone: document.getElementById('new-address-phone').value,
                    street: document.getElementById('new-address-street').value,
                    city: document.getElementById('new-address-city').value,
                    province: document.getElementById('new-address-province').value,
                    postalCode: document.getElementById('new-address-postal').value,
                    isDefault: document.getElementById('new-address-default').checked
                };
                
                // Validate required fields
                if (!newAddress.name || !newAddress.recipient || !newAddress.phone || !newAddress.street || 
                    !newAddress.city || !newAddress.province || !newAddress.postalCode) {
                    alert('Please fill in all required fields');
                    return;
                }
                
                // Save to user data
                if (!currentUser.addresses) {
                    currentUser.addresses = [];
                }
                currentUser.addresses.push(newAddress);
                
                // Update localStorage
                const users = JSON.parse(localStorage.getItem('users') || '[]');
                const userIndex = users.findIndex(u => u.email === currentUser.email);
                if (userIndex !== -1) {
                    users[userIndex] = currentUser;
                    localStorage.setItem('users', JSON.stringify(users));
                }
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                
                // Refresh addresses
                populateAddresses();
                showNotification('Address added successfully!');
            });
        }
        
        // Reset checkout process
        function resetCheckout() {
            checkoutData = {
                address: null,
                outlet: null,
                shipping: null,
                payment: null,
                voucher: null,
                orderTempId: null
            };
            appliedVoucher = null;
            navigateToStep(1);
        }

        // Initialize modals
        function initModals() {
            const loginModal = document.getElementById('login-modal');
            const registerModal = document.getElementById('register-modal');
            const forgotPasswordModal = document.getElementById('forgot-password-modal');
            const subscriptionModal = document.getElementById('subscription-modal');
            const closeLogin = document.getElementById('close-login');
            const closeRegister = document.getElementById('close-register');
            const closeForgotPassword = document.getElementById('close-forgot-password');
            const closeSubscription = document.getElementById('close-subscription');
            const showRegister = document.getElementById('show-register');
            const showLogin = document.getElementById('show-login');
            const showForgotPassword = document.getElementById('show-forgot-password');
            const showLoginFromForgot = document.getElementById('show-login-from-forgot');
            const loginFromCheckout = document.getElementById('login-from-checkout');
            
            // Close login modal
            closeLogin.addEventListener('click', function() {
                loginModal.classList.remove('active');
                resetErrorMessages('login');
            });
            
            // Close register modal
            closeRegister.addEventListener('click', function() {
                registerModal.classList.remove('active');
                resetErrorMessages('register');
            });
            
            // Close forgot password modal
            closeForgotPassword.addEventListener('click', function() {
                forgotPasswordModal.classList.remove('active');
                resetErrorMessages('forgot-password');
            });
            
            // Close subscription modal
            closeSubscription.addEventListener('click', function() {
                subscriptionModal.classList.remove('active');
            });
            
            // Show register modal
            showRegister.addEventListener('click', function(e) {
                e.preventDefault();
                loginModal.classList.remove('active');
                registerModal.classList.add('active');
                resetErrorMessages('login');
            });
            
            // Show login modal
            showLogin.addEventListener('click', function(e) {
                e.preventDefault();
                registerModal.classList.remove('active');
                loginModal.classList.add('active');
                resetErrorMessages('register');
            });
            
            // Show forgot password modal
            showForgotPassword.addEventListener('click', function(e) {
                e.preventDefault();
                loginModal.classList.remove('active');
                forgotPasswordModal.classList.add('active');
                resetErrorMessages('login');
            });
            
            // Show login from forgot password
            showLoginFromForgot.addEventListener('click', function(e) {
                e.preventDefault();
                forgotPasswordModal.classList.remove('active');
                loginModal.classList.add('active');
                resetErrorMessages('forgot-password');
            });
            
            // Login from checkout
            loginFromCheckout.addEventListener('click', function() {
                document.getElementById('login-required-message').classList.remove('active');
                document.getElementById('login-modal').classList.add('active');
            });
            
            // Close modals when clicking outside
            window.addEventListener('click', function(e) {
                if (e.target === loginModal) {
                    loginModal.classList.remove('active');
                    resetErrorMessages('login');
                }
                if (e.target === registerModal) {
                    registerModal.classList.remove('active');
                    resetErrorMessages('register');
                }
                if (e.target === forgotPasswordModal) {
                    forgotPasswordModal.classList.remove('active');
                    resetErrorMessages('forgot-password');
                }
                if (e.target === subscriptionModal) {
                    subscriptionModal.classList.remove('active');
                }
                if (e.target === document.getElementById('login-required-message')) {
                    document.getElementById('login-required-message').classList.remove('active');
                }
                if (e.target === document.getElementById('account-modal')) {
                    document.getElementById('account-modal').classList.remove('active');
                }
                
                // Close user dropdown when clicking outside
                if (!e.target.closest('#user-icon-container') && !e.target.closest('#user-dropdown')) {
                    document.getElementById('user-dropdown').classList.remove('active');
                }
            });
        }

        // Initialize search functionality
        function initSearch() {
            const searchInput = document.querySelector('.search-input');
            const searchResults = document.querySelector('.search-results');
            
            searchInput.addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase().trim();
                
                if (searchTerm.length < 2) {
                    searchResults.style.display = 'none';
                    return;
                }
                
                // Search through all products
                const results = searchProducts(searchTerm);
                displaySearchResults(results, searchTerm);
            });
            
            // Hide search results when clicking outside
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.search-container')) {
                    searchResults.style.display = 'none';
                }
            });
        }
        
        // Search through products
        function searchProducts(searchTerm) {
            const results = [];
            
            // Search in all categories
            productsData.categories.forEach(category => {
                category.products.forEach(product => {
                    if (product.name.toLowerCase().includes(searchTerm) || 
                        product.description.toLowerCase().includes(searchTerm) ||
                        category.name.toLowerCase().includes(searchTerm)) {
                        results.push({
                            type: 'Product',
                            title: product.name,
                            description: product.description,
                            category: category.name,
                            data: product
                        });
                    }
                });
            });
            
            return results;
        }
        
        // Display search results
        function displaySearchResults(results, searchTerm) {
            const searchResults = document.querySelector('.search-results');
            
            if (results.length === 0) {
                searchResults.innerHTML = '<div class="search-result-item">No products found</div>';
                searchResults.style.display = 'block';
                return;
            }
            
            searchResults.innerHTML = '';
            
            results.forEach(result => {
                const resultItem = document.createElement('div');
                resultItem.className = 'search-result-item';
                
                // Highlight search term in title and description
                const highlightedTitle = highlightText(result.title, searchTerm);
                const highlightedDescription = highlightText(result.description, searchTerm);
                
                resultItem.innerHTML = `
                    <div><strong>${result.type}: ${highlightedTitle}</strong></div>
                    <div style="font-size: 12px; color: #666;">${highlightedDescription}</div>
                    <div style="font-size: 11px; color: #999;">Category: ${result.category}</div>
                `;
                
                resultItem.addEventListener('click', function() {
                    // Navigate to the category and highlight the product
                    if (currentCategory !== result.data.category) {
                        // Change to the correct category
                        document.querySelectorAll('.category-btn').forEach(btn => {
                            btn.classList.remove('active');
                            if (btn.getAttribute('data-category') === result.data.category) {
                                btn.classList.add('active');
                                currentCategory = result.data.category;
                                displayCategoryProducts(result.data.category);
                            }
                        });
                    }
                    
                    // Close search results
                    searchResults.style.display = 'none';
                    document.querySelector('.search-input').value = '';
                    
                    // Scroll to the product
                    setTimeout(() => {
                        const productElement = document.querySelector(`[data-id="${result.data.id}"]`);
                        if (productElement) {
                            productElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            
                            // Add highlight effect
                            productElement.closest('.product-card').style.boxShadow = '0 0 0 3px var(--yellow)';
                            setTimeout(() => {
                                productElement.closest('.product-card').style.boxShadow = '';
                            }, 2000);
                        }
                    }, 500);
                });
                
                searchResults.appendChild(resultItem);
            });
            
            searchResults.style.display = 'block';
        }
        
        // Highlight search term in text
        function highlightText(text, searchTerm) {
            const regex = new RegExp(`(${searchTerm})`, 'gi');
            return text.replace(regex, '<span class="highlight">$1</span>');
        }

        // Initialize flash sale timer
        function initFlashSaleTimer() {
            // Set end time for flash sale (24 hours from now)
            const endTime = new Date();
            endTime.setHours(endTime.getHours() + 24);
            
            function updateTimer() {
                const now = new Date();
                const timeLeft = endTime - now;
                
                if (timeLeft <= 0) {
                    // Flash sale ended
                    document.getElementById('days').textContent = '00';
                    document.getElementById('hours').textContent = '00';
                    document.getElementById('minutes').textContent = '00';
                    document.getElementById('seconds').textContent = '00';
                    return;
                }
                
                // Calculate time components
                const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
                const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
                
                // Update timer display
                document.getElementById('days').textContent = days.toString().padStart(2, '0');
                document.getElementById('hours').textContent = hours.toString().padStart(2, '0');
                document.getElementById('minutes').textContent = minutes.toString().padStart(2, '0');
                document.getElementById('seconds').textContent = seconds.toString().padStart(2, '0');
            }
            
            // Update timer immediately and then every second
            updateTimer();
            setInterval(updateTimer, 1000);
        }

        // Initialize mobile menu
        function initMobileMenu() {
            const mobileMenu = document.querySelector('.mobile-menu');
            const nav = document.querySelector('nav');
            
            mobileMenu.addEventListener('click', function() {
                if (nav.style.display === 'block') {
                    nav.style.display = 'none';
                } else {
                    nav.style.display = 'block';
                }
            });
        }

        // Helper function to reset error messages
        function resetErrorMessages(formType) {
            const errorMessages = document.querySelectorAll(`#${formType}-form .error-message`);
            errorMessages.forEach(msg => {
                msg.style.display = 'none';
            });
        }

        // Notification function
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 100px;
                right: 20px;
                background-color: var(--dark-green);
                color: white;
                padding: 15px 20px;
                border-radius: 5px;
                z-index: 10000;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
                transition: transform 0.3s, opacity 0.3s;
                transform: translateX(100%);
                opacity: 0;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            // Animate in
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
                notification.style.opacity = '1';
            }, 10);
            
            // Animate out after 3 seconds
            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                notification.style.opacity = '0';
                
                // Remove from DOM after animation
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        // Initialize product detail page
        function initProductDetailPage() {
            const productDetailBack = document.getElementById('product-detail-back');
            const productDetailAddToCart = document.getElementById('product-detail-add-to-cart');
            const productDetailBuyNow = document.getElementById('product-detail-buy-now');
            
            // Back button
            productDetailBack.addEventListener('click', function() {
                document.getElementById('product-detail-page').classList.remove('active');
            });
            
            // Add to cart button
            productDetailAddToCart.addEventListener('click', function() {
                const productId = document.getElementById('product-detail-page').getAttribute('data-product-id');
                addToCart(productId);
                document.getElementById('product-detail-page').classList.remove('active');
            });
            
            // Buy now button
            productDetailBuyNow.addEventListener('click', function() {
                const productId = document.getElementById('product-detail-page').getAttribute('data-product-id');
                addToCart(productId);
                document.getElementById('product-detail-page').classList.remove('active');
                
                // Open cart drawer
                document.getElementById('cart-drawer').classList.add('active');
                updateCartDisplay();
            });
        }

        // Show product detail page
        function showProductDetail(productId) {
            // Find product in all categories
            let product = null;
            for (const category of productsData.categories) {
                product = category.products.find(p => p.id == productId);
                if (product) break;
            }
            
            if (!product) return;
            
            // Split description into paragraphs
            const descriptionParagraphs = product.description.split('\n\n');
            
            // Populate product detail page
            document.getElementById('product-detail-image').innerHTML = `
                <img src="${product.image}" alt="${product.name}" onerror="this.innerHTML='[${product.name} Image]'">
            `;
            document.getElementById('product-detail-name').textContent = product.name;
            document.getElementById('product-detail-price').textContent = product.price;
            document.getElementById('product-detail-wholesale').textContent = product.wholesale;
            
            // Populate description as paragraphs
            const descriptionContainer = document.getElementById('product-detail-description');
            descriptionContainer.innerHTML = '';
            
            descriptionParagraphs.forEach(paragraph => {
                if (paragraph.trim()) {
                    const p = document.createElement('p');
                    p.textContent = paragraph;
                    descriptionContainer.appendChild(p);
                }
            });
            
            // Set product ID for add to cart functionality
            document.getElementById('product-detail-page').setAttribute('data-product-id', product.id);
            
            // Show product detail page
            document.getElementById('product-detail-page').classList.add('active');
        }

        // Smooth scrolling for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();
                
                const targetId = this.getAttribute('href');
                if (targetId === '#') return;
                
                const targetElement = document.querySelector(targetId);
                if (targetElement) {
                    window.scrollTo({
                        top: targetElement.offsetTop - 80,
                        behavior: 'smooth'
                    });
                    
                    // Close mobile menu if open
                    if (window.innerWidth <= 768) {
                        document.querySelector('nav').style.display = 'none';
                    }
                }
            });
        });
    </script>
</body>
</html>